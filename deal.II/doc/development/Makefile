# $Id$


D = ../..
include $D/common/Make.global_options


default: makefiles.html makefile.small.html makefile.large.html makefile.rules.html


makefiles.html: Makefile makefiles.1.html $D/common/Make.global_options makefiles.2.html
	@cat makefiles.1.html > $@
	@echo '<li><code>D=$D</code>' >> $@
	@echo '<li><code>CXX=$(CXX)</code>' >> $@
	@echo '<li><code>CC=$(CC)</code>' >> $@
	@echo '<li><code>F77=$(F77)</code>' >> $@
	@echo '<li><code>GXX-VERSION=$(GXX-VERSION)</code>' >> $@
	@echo '<li><code>CC-VERSION=$(CC-VERSION)</code>' >> $@
	@echo '<li><code>F77-VERSION=$(F77-VERSION)</code>' >> $@
	@echo '<li><code>SHLIBLD=$(SHLIBLD)</code>' >> $@
	@echo '<li><code>OBJEXT=$(OBJEXT)</code>' >> $@
	@echo '<li><code>EXEEXT=$(EXEEXT)</code>' >> $@
	@echo '<li><code>enable-shared=$(enable-shared)</code>' >> $@
	@echo '<li><code>PERL=$(PERL)</code>' >> $@
	@echo '<li><code>DEAL_II_MAJOR=$(DEAL_II_MAJOR)</code>' >> $@
	@echo '<li><code>DEAL_II_MINOR=$(DEAL_II_MINOR)</code>' >> $@
	@echo '<li><code>TARGET=$(TARGET)</code>' >> $@
	@echo '<li><code>USE_CONTRIB_HSL=$(USE_CONTRIB_HSL)</code>' >> $@
	@echo '<li><code>USE_CONTRIB_PETSC=$(USE_CONTRIB_PETSC)</code>' >> $@
	@echo '<li><code>DEAL_II_PETSC_DIR=$(DEAL_II_PETSC_DIR)</code>' >> $@
	@echo '<li><code>DEAL_II_PETSC_ARCH=$(DEAL_II_PETSC_ARCH)</code>' >> $@
	@echo '<li><code>USE_CONTRIB_METIS=$(USE_CONTRIB_METIS)</code>' >> $@
	@echo '<li><code>DEAL_II_METIS_DIR=$(DEAL_II_METIS_DIR)</code>' >> $@
	@echo '<li><code>lib-path-base=$(lib-path-base)</code>' >> $@
	@echo '<li><code>lib-path-lac=$(lib-path-lac)</code>' >> $@
	@echo '<li><code>lib-path-deal2=$(lib-path-deal2)</code>' >> $@
	@echo '<li><code>LIBPATH=$(LIBPATH)</code>' >> $@
	@echo '<li><code>LIBS=$(LIBS)</code>' >> $@
	@echo '<li><code>static-lib-suffix=$(static-lib-suffix)</code>' >> $@
	@echo '<li><code>shared-lib-suffix=$(shared-lib-suffix)</code>' >> $@
	@echo '<li><code>lib-suffix=$(lib-suffix)</code>' >> $@
	@echo '<li><code>lib-base.o=$(lib-base.o)</code>' >> $@
	@echo '<li><code>lib-base.g=$(lib-base.g)</code>' >> $@
	@echo '<li><code>lib-lac.o=$(lib-lac.o)</code>' >> $@
	@echo '<li><code>lib-lac.g=$(lib-lac.g)</code>' >> $@
	@echo '<li><code>lib-deal2-1d.o=$(lib-deal2-1d.o)</code>' >> $@
	@echo '<li><code>lib-deal2-1d.g=$(lib-deal2-1d.g)</code>' >> $@
	@echo '<li><code>lib-deal2-2d.o=$(lib-deal2-2d.o)</code>' >> $@
	@echo '<li><code>lib-deal2-2d.g=$(lib-deal2-2d.g)</code>' >> $@
	@echo '<li><code>lib-deal2-3d.o=$(lib-deal2-3d.o)</code>' >> $@
	@echo '<li><code>lib-deal2-3d.g=$(lib-deal2-3d.g)</code>' >> $@
	@echo '<li><code>lib-contrib-hsl=$(lib-contrib-hsl)</code>' >> $@
	@echo '<li><code>lib-contrib-petsc.g=$(lib-contrib-petsc.g)</code>' >> $@
	@echo '<li><code>lib-contrib-petsc.o=$(lib-contrib-petsc.o)</code>' >> $@
	@echo '<li><code>lib-contrib-metis=$(lib-contrib-metis)</code>' >> $@
	@echo '<li><code>include-path-base=$(include-path-base)</code>' >> $@
	@echo '<li><code>include-path-lac=$(include-path-lac)</code>' >> $@
	@echo '<li><code>include-path-deal2=$(include-path-deal2)</code>' >> $@
	@echo '<li><code>include-path-contrib-hsl=$(include-path-contrib-hsl)</code>' >> $@
	@echo '<li><code>include-path-contrib-petsc=$(include-path-contrib-petsc)</code>' >> $@
	@echo '<li><code>include-path-contrib-petsc-bmake=$(include-path-contrib-petsc-bmake)</code>' >> $@
	@echo '<li><code>include-path-contrib-metis=$(include-path-contrib-metis)</code>' >> $@
	@echo '<li><code>INCLUDE=$(INCLUDE)</code>' >> $@
	@echo '<li><code>CXXFLAGS.g=$(CXXFLAGS.g)</code>' >> $@
	@echo '<li><code>CXXFLAGS.o=$(CXXFLAGS.o)</code>' >> $@
	@echo '<li><code>CFLAGS=$(CFLAGS)</code>' >> $@
	@echo '<li><code>F77FLAGS.g=$(F77FLAGS.g)</code>' >> $@
	@echo '<li><code>F77FLAGS.o=$(F77FLAGS.o)</code>' >> $@
	@echo '<li><code>LDFLAGS=$(LDFLAGS)</code>' >> $@
	@echo '<li><code>F77LIBS=$(F77LIBS)</code>' >> $@
	@echo '<li><code>ACE_ROOT=$(ACE_ROOT)</code>' >> $@
	@echo '<li><code>lib-ACE=$(lib-ACE)</code>' >> $@
	@echo '<li><code>with-multithreading=$(with-multithreading)</code>' >> $@
	@echo '<li><code>TECIO_INCLUDE=$(TECIO_INCLUDE)</code>' >> $@
	@echo '<li><code>TECIO_LIBRARY=$(TECIO_LIBRARY)</code>' >> $@
	@cat makefiles.2.html >> $@


makefile.small.html: Makefile.small
	@$(PERL) makefile2html < $< > $@

makefile.large.html: Makefile.large
	@$(PERL) makefile2html < $< > $@

makefile.rules.html: $D/common/Makefile.template
	@$(PERL) makefile2html < $< > $@

validate-xrefs:
	@$(PERL) $D/common/scripts/validate-xrefs.pl \
		$(filter-out makefiles.1.html makefiles.2.html, \
		  $(shell echo *.html))



clean:
	-rm -f makefiles.html makefile.small.html makefile.large.html

.PHONY: default validate-xrefs clean
