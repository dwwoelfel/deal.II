<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"
   "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
  <head>
    <link href="../screen.css" rel="StyleSheet" title="deal.II Homepage" media="screen">
    <link href="../print.css" rel="StyleSheet" title="deal.II Homepage" media="print">
    <title>The deal.II Homepage - Makefiles</title>
    <meta name="author" content="Wolfgang Bangerth <deal@iwr.uni-heidelberg.de>">
    <meta name="keywords" content="deal.II"></head>
  <body>


    <h2>Writing Documentation</h2>

    <p>
    It is our firm belief that software can only be successful if it
    is properly documented. Too many academic software projects die
    prematurely once their creators leave the university or the
    workgroup in which the software was developed since with their
    creators also knowledge of internal structures, interfaces, and
    the valuable bag of tricks leaves, a gap that can not be closed by
    reading sources, trial-and-error, and guessing.
    </p>

    <p>
    The <acronym>deal.II</acronym> project has therefore from its
    infancy adopted a policy that every aspect of the interface
    needs to be well-documented before its inclusion into the
    source tree. Since we have found that it is impossible to keep
    documentation up-to-date if it is not written directly into the
    program code, we write the documentation directly at the place of
    declaration of a function or class and use automatic tools to
    extract this information from the files and process it into HTML
    for our web-pages, or LaTeX for printing.
    </p>

    <p>
    In addition to the API documentation, we maintain a series of
    <a href="../tutorial/chapter-2.step-by-step/index.html" target="_top">
    well-documented example programs</a>, which also follow a certain
    ``literate programming'' style in that the explanations of what
    is happening are integrated into the program source by means of
    comments, and are extracted by small scripts.
    </p>

    <p>
    This document first explains the basics of 
    <a href="#API" target="body">documenting the API</a> and then of
    <a href="#examples" target="body">writing example programs</a>.
    </p>


    <a name="API">
    <h3>Writing API documentation</h3>

    <p>
    In order to extract documentation from the header files of the
    project, we use a modified version of 
    <a href="http://www.ph.unimelb.edu.au/~ssk/kde/kdoc/" target="_top">kdoc</a>,
    written by Sirtaj Singh Kang,
    which is one of the documentation tools of the
    <a href="http://www.kde.org" target="_top">KDE</a>
    project. It requires that documentation is written in a form which
    closely follows the 
    <a href="http://java.sun.com/products/jdk/javadoc/index.html" target="_top">
    JavaDoc</a> standard, with some small additions which we will
    explain below. The patched version of kdoc is included into the
    library and can be found in the
    <code>deal.II/contrib/kdoc</code> directory.
    </p>

    <p>
    Alternatively, one can use
    <a href="http://www.linuxsupportline.com/~doc++/">Doc++</a> to
    create a LaTeX document from the sources which can then be
    printed. Due to the size of the resulting file (at present 1500+
    pages, with tendencies to further growth), you will not want to do
    that regularly, though.
    </p>


    <h4>Basic layout of documentation</h4>

    <p>
    Basically, every declaration, whether class or member
    function/variable declaration, may be preceded by a comment of the
    following form:
    <code>
    <pre>
      /**
       * This is an example documentation.
       *
       * @author Wolfgang Bangerth, 2000
       */
      class TestClass 
      {
        public:
                 /**
		  * Constructor
		  */
          TestClass (); 

                 /**
		  * Example function
		  */
          virtual void test () const = 0;

                 /**
		  * Member variable
		  */
          const unsigned int abc;
      };
    </pre>
    </code>
    <acronym>kdoc</acronym> will then generate a page for the class
    <code>TestClass</code> and document each of the member functions
    and variables. The content of the <code>@author</code> tag will be
    included into the online documentation of the class.
    </p>

    <p>
    There is one exception to the rule that every member can be
    documented separately: due to internal restrictions of the
    <code>kdoc2</code> tool by which the documentation is generated,
    elements of en enumeration type (i.e. an <code>enum</code> object
    in technical terminus) may not be documented right above their
    declaration, but must be documented atop of the <code>enum</code>
    declaration. (This is due to the fact that inside enums,
    <code>kdoc2</code> does not parse the elements separately at
    present, but rather the whole enum as one.)
    </p>

    
    <h4>Extended Layout</h4>

    <p>
    In order to allow better structured output for long comments, we
    have extended <acronym>kdoc</acronym> to understand the following
    tags inside comments, which are partly borrowed from LaTeX like
    languages: 
    <ul>
    <li> <em>Itemized lists:</em>
         <p>
	 By writing comments like the following,
	 <code><pre>
	   /**
	    * @begin{itemize}
	    *   @item foo
	    *   @item bar
	    * @end{itemize}
	    */
	 </pre></code>
	 you can get itemized lists both in the online and printed
	 documentation:
	 <ul>
	 <li> foo
	 <li> bar
	 </ul> 
	 </p>
	 
	 <p>
	 Likewise, you can get numbered lists by using the tags
	 <code>@begin{enumerate}</code> and
	 <code>@end{enumerate}</code> along with <code>@item</code>s. 
	 </p>

    <li> <em>Verbatim output:</em>
         <p>
	 If you write comments like this,
	 <code><pre>
	   /**
	    * @begin{verbatim}
	    *   void foobar ()
	    *   {
	    *     i = 0;
	    *   };
	    * @end{verbatim}
	    */
	 </pre></code>
	 you will get the lines between the verbatim environment with
	 the same formatting and in typewriter font:
	 <code><pre>
     void foobar ()
     {
       i = 0;
     };
	 </pre></code>
	 This is useful if you want to include small sample code snippets
	 into your documentation. In particular, it is important that
	 the formatting is preserved, which is not the case for all
	 other text.
	 </p>

    <li> <em>Typewriter font:</em>
         <p>
	 One would often like to use a typewriter font for variable,
	 function, or class names. For this, the <code>@p{...}</code>
	 tag is used, which generates output in which the content
	 inside the braces is set in typewriter font.
	 </p>

	 <p>
	 As a convention, we always enclose variable and function
	 names into <code>@p{...}</code> in order to give them a visible
	 distinction.
	 </p>

    <li> <em>Emphasis:</em>
         <p>
	 To generate output in italics, use the <code>@em{...}</code> tag.
	 </p>

    <li> <em>Sections:</em>
         <p>
	 Sections can be generated using <code>@sect1{...},
	 @sect2{...}, @sect3{...}, @sect4{...}</code> tags. We don't
	 normally use <code>@sect1{...}</code> as it produces section
	 titles that are overly large compared to the rest of a page.
	 </p>
    </ul>
    </p>



    <h4>Future directions</h4>

    <p>
    We are considering switching to DocBook SGML instead of Latex for
    printed output. At present, printing of some documentation, most
    notably the example programs is not really supported, and we
    consider ways to convert them to SGML along with most other
    documentation, since SGML is readily convertible into many other
    formats, for example Postscript.
    </p>



    <a name="examples">
    <h3>Writing example programs</h3>

    <p>
    At present, the tools that extract information from the example
    programs are rather dumb. They are, to be precise, two Perl
    scripts located in the directory of the
    <code>deal.II/doc/tutorial</code> tree, where the HTML files are
    generated. In principle, they extract plain text from all comments
    in the programs that start with a double slash (C++ style
    comment). Everything else is interpreted as program text and is
    copied verbatim into the output.
    </p>

    <p>
    In the future, it would certainly help if the scripts understood
    something like a <code>title</code> or <code>section</code> tag
    (preferably something similar to the DocBook SGML commands for
    that) in the comments, which could help to better structure the
    output, especially for the longer programs. One would probably
    like to put a section break before each new function or class, or
    something along these lines.
    </p>


    <hr>
    
    <address>
      <a href="../mail.html">The deal.II mailing list</a></address>

  </body>
</html>

