<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" 
    "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
<head>
  <title>DEAL tutorial: the Laplace problem</title>
  <meta name="keyword" content="DEAL,DEAL tutorial">
  <link href="../dealtut.css" rel="StyleSheet" media="screen" type="text/css" title="DEAL tutorial">
  <meta name="author" content="Jan Schrage <schrage@gaia.iwr.uni-heidelberg.de>">
  <meta name="keywords" content="DEAL,DEAL tutorial">
</head>
<body>

<h1>The Laplace Problem</h1>
  
<h2>Main Program: <a href="../../../examples/01.laplace/main.cc">main.cc</a></h2>
<p>
The main program has several functions:
</p>

<ol>
   <li> <a href="#program">Inclusion of the necessary headers and variable
	definitions.</a>
   </li>
   <li>
	<a href="#Instantiation">Instantiation of  the C++ class <em>Laplace</em>
	  dealing with the problem</a>.
   </li>
   <li><a href="#laplace">Calling the <em>Laplace</em> methods for assemblage and solution of the
       problem.</a>
   </li>
   <li>
       <a href="#output">Writing out of the output data and termination.</a>
   </li>
</ol>
    
<p>
We shall look at this in detail now:
</p>
    
<h4><a name="Program">Program Header and Definitions</a></h4>
    
<p>
First the header files containing the <em>Laplace</em> class definition and
the function definition for our solution function are included:
</p>

<pre>
<code>
#include "<a href="../../../examples/01.laplace/laplace.h">laplace.h</a>"
#include "<a href="../../../examples/01.laplace/functions.h">functions.h</a>"
</code>
</pre>
    
<p>
Our main program starts here. It will take the initial number of global grid
refinements as its argument. That means that the number 3 as argument will
lead to the initial grid being globally refined three times, no questions
asked.
</p>

<pre>
<code>
main(int argc, char** argv) 
{
</code>
</pre>
<h4><a name="Instantiation">Instantiation of needed classes</a></h4>
<p>
We need a solution function and an instance of the class dealing with the
Laplace problem:
</p>

<pre>
<code>
Laplace lap;
</code>
</pre>

<p>
In addition we need to do some refinement (the command line argument was
previously stored in the variable <var>firstgrid</var>.
</p>
<pre><code>
for (unsigned step = 0; step &lt; 3 ; ++step)   
{     
  
  if (!step) 
     lap.remesh(firstgrid);
  else
  {
     lap.remesh(1);
  }
</code></pre>

<h4><a name="laplace">Problem assemblage and solution</a></h4>
<p>
Our class assembles and solves the primal problem; the solution is exact (as defined above) 
and the right hand side of the equation is zero (as defined above). If the right
hand side were not zero we would solve the Poisson equation instead.
</p>
<pre><code>
  lap.assemble_primal(boundary, zero); 
  lap.solve_primal();          
</code></pre>

<h4><a name="output">Data output</a></h4>
<p>
Finally the solution is written to a file.</p>
<pre>
<code>
  sprintf(fname,"T%02d",step);    
  lap.write_data(fname);   
 }   
}
</code></pre>
<hr>
<p>
<a href="../index.html">Back to the tutorial index</a>
</p>
<hr>
<address>
  <a href="mailto:schrage@gaia.iwr.uni-heidelberg.de">Jan Schrage</a></address>
<p>
Last modified: Wed 6 Jan 1999
</p>

</body>
</html>
