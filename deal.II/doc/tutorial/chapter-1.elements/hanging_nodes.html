<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN"
   "http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<!-- deal.II tutorial template
     Jan Schrage and others <deal@iwr.uni-heidelberg.de> 1999 
-->

<title>deal.II tutorial: Hanging Nodes</title>
    <link href="../../screen.css" rel="StyleSheet" title="deal.II Tutorial" media="screen">
    <link href="../../print.css" rel="StyleSheet" title="deal.II Tutorial" media="print">
    <meta name="author" content="the deal.II authors <authors@dealii.org>">
    <meta name="keywords" content="deal.II,deal.II tutorial,deal II">
</head>

<!-- Page Body -->
<body lang="en">

<h1>Hanging Nodes</h1>

This chapter discusses one aspect of locally refined grids. Using the
approach chosen in <acronym>deal.II</acronym>, grids are produced with
so-called hanging nodes.
A node is called hanging if its value is subject to a 
constraint induced by the requirement of globally continuous
functions. We will make this clearer in the following.

<h2>When do you get hanging nodes?</h2>

<p>
You get hanging nodes after some refinements. Hanging nodes are those that 
are situated on the boundary of a larger active cell. The global function 
is assumed
to be linear on the boundary of each active cell, therefore the value
of the hanging node must be adjusted accordingly. Newly created nodes that
are not situated on boundaries of larger active cells are not subject to this 
constraint because there is no reason to assume that the global function
is linear on the boundary of a parent cell.
Hanging nodes 
and the constraints they are subject to need to be
taken into account when generating your matrix structure.
This is further discussed in the chapters on
<a href="matrix_structure.html">matrix structure</a> and 
<a href="condense.html">condensing the hanging nodes</a>.
</p>

<table class="figure">
<caption class="figure" align=bottom>Hanging nodes on a locally refined grid</caption>
<td>
<img src="../images/hanging_nodes.gif" width=405 height=254
      alt="Hanging Nodes">
</td>
</table>

<h2>Constraints on Hanging Nodes</h2>

<h3>Where do the constraints come from?</h3>
<p>
In order to get constraints for your hanging nodes you have to assume
some function on the boundaries of your cells, as mentioned above.
Take a linear function on the cell boundary between vertices 1 and 2
with function values <code>x1</code> and <code>x2</code>. If you get
a hanging node on this boundary during refinement it will be situated
in the middle and therefore its value - the value of the function on 
the boundary at this point - will be <code>x3 = 1/2 (x1+x2)</code>.
The value <code>x3</code> is therefore not a free degree of freedom,
but it is bound by this constraining equation and we will have to take
this into account.
</p>

<h3>Mathematical implications, or<br>
why is it a constraint <em>matrix</em> ?</h3>

<p>
Assume a system <code>Au=f</code> with <code>u</code> being the solution
vector with all the degrees of freedom of the finite elements, in particular
base functions associated with hanging nodes, which are not true degrees of 
freedom of the system of equations.
</p>
<p>
The constraint for hanging nodes now is that we must be able to calculate
their value from the values of the surrounding nodes by interpolation.
Let <code>y</code> be a vector with entries corresponding to true degrees of
freedom only. We must be able to write <code>u</code> as <br>
<code>u=Cy</code><br>
where <code>C</code>, the constraint matrix is a square matrix containing the 
interpolation.
</p>
<p>
Now we have to solve
</p>
<pre>
<code>
  Au = f
</code>
with the constraint, that there is a <code>y</code> satisfying
<code>
  u = Cy
</code>
From this we get
<code>
  C<sup>T</sup>ACy = C<sup>T</sup>f
</code>
or, taking
<code>
  ~A := C<sup>T</sup>AC, b := C<sup>T</sup>f 
  ~A y = b.
</code>
</pre>

<p>
It is not possible to generate <code>~A</code> directly, but 
we can generate <code>A</code> and condense it to <code>~A</code>
using the constraints, solve the system and obtain <code>u</code> by
<code>u=Cy</code>.
</p>
<!-- Page Foot -->
<hr>
<table class="navbar">      
<tr>
  <td>
    <a href="matrix_structure.html">Next Chapter: Matrix Structure</a>
  </td>
  <td>
    <a href="toc.html">Back to this chapter's index</a>
  </td>
  <td>
    <a href="../index.html" target="_top">Back to the tutorial index</a>
  </td>
</tr>
</table>
<hr>
<address>
<a href="../../mail.html">The deal.II group</a></address>
<p>

</p>
</body>
</html>
