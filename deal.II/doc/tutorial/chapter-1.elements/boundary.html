<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"
   "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
<head>
<!-- deal.II tutorial template
     Jan Schrage and others <deal@iwr.uni-heidelberg.de> 1999 
-->

<title>deal.II tutorial: Boundary conditions</title>
    <link href="../../screen.css" rel="StyleSheet" title="deal.II Tutorial" media="screen">
    <link href="../../print.css" rel="StyleSheet" title="deal.II Tutorial" media="print">
    <meta name="author" content="Jan Schrage and others <deal@iwr.uni-heidelberg.de>">
    <meta name="keywords" content="deal.II,deal.II tutorial,deal II">
</head>

<!-- Page Body -->
<body lang="en">

<h1>Boundary Conditions</h1>

<h2><a name="boundary">Setting boundary conditions</a></h2>

<p>
There are two <acronym>deal.II</acronym> functions relevant for us at the moment:
</p>
<pre>
<code>
void VectorTools::interpolate_boundary_values(...)
</code>
</pre>
<p>
which does exactly what it says. This function accepts a number
describing which part of the boundary we want to consider
and the according function which shall be interpolated on that portion
of the boundary. It returns a list of
pairs of degrees of freedom numbers and values denoting the respective 
Dirichlet boundary values.
</p>
<p>
This output is used by
</p>
<pre>
<code>
void MatrixTools::apply_boundary_values(...)
</code>
</pre>
<p>
that inserts the proper boundary conditions into the system of equations.
</p>

<p class="example">
<span class="example">Example:</span> We insert Dirichlet boundary conditions into 
a system of equations of the form <code>Au=f</code>. The vectors <code>u</code> and 
<code>f</code> and the matrix <code>A</code> have already been initialized, likewise
the handler for the degrees of freedom <code>dof</code> and the corresponding finite
element <code>fe</code>.
</p>
<pre class="example"><code>
                      // this will hold the boundary value for
                      // the degrees of freedom on the boundary
                      // part with number '0'
map&lt;int,double&gt; boundary_values;
                      // and this is some user-defined function
                      // describing the boundary values
BoundaryFunction&lt;dim&gt; boundary_function;
                      // interpolate the DoFs on boundary
                      // portion '0':
VectorTools&lt;dim&gt;::interpolate_boundary_values 
               (dof_handler,
                0, boundary_function, 
                boundary_values);

                      // set solution vector to the right size
u.reinit(dof_handler.n_dofs());
                      // we assume that the global matrix and
                      // right hand side have already been
                      // assembled.

                      // now insert the boundary values into
                      // the linear system of equations:
MatrixTools&lt;dim&gt;::apply_boundary_values 
               (boundary_values,
                A, u, f);  
</code></pre>
<p>
You may have several different parts of the boundary which are
identified by different boundary indicators. For example, this is
commonly the case if you have inflow and outflow boundaries, or if
your domain has inner boundaries, such as obstacles inside your
domain. You may then want to associate different boundary functions
with the different parts of the boundary, and you can do so by
multiply calling <code>interpolate_boundary_values</code> with
different boundary indicators (the <code>'0'</code> above) and
respective functions. Since the function does not clear the contents
of the map, you may use it for each of this successive calls and pass
only the final object to <code>apply_boundary_values</code>.


<!-- Page Foot -->
<hr>
<table class="navbar">      
<tr>
  <td>
    <a href="condense.html">Next Chapter: Condensing the Hanging Nodes</a>
  </td>
  <td>
    <a href="toc.html">Back to this chapter's index</a>
  </td>
  <td>
    <a href="../index.html" target="_top">Back to the tutorial index</a>
  </td>
</tr>
</table>
<hr>
<address>
<a href="mailto:deal@iwr.uni-heidelberg.de">The deal.II group</a></address>
<p>
Last modified: $Date$ 
</p>
</body>
</html>
