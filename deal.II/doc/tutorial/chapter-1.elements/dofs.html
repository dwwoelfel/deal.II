<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"
   "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
<head>
<!-- deal.II tutorial template
     Jan Schrage and others <deal@iwr.uni-heidelberg.de> 1999 
-->

<title>deal.II tutorial: Degrees of Freedom</title>
    <link href="../../screen.css" rel="StyleSheet" title="deal.II Tutorial" media="screen">
    <link href="../../print.css" rel="StyleSheet" title="deal.II Tutorial" media="print">
    <meta name="author" content="Jan Schrage and others <deal@iwr.uni-heidelberg.de>">
    <meta name="keywords" content="deal.II,deal.II tutorial,deal II">
</head>

<!-- Page Body -->
<body lang="en">

<h1>Degrees of Freedom</h1>

<p>
Degrees of freedom - short DoFs - are needed to associate a numering
to the shape functions living on our triangulation. Using this
numbering, we can then interpret the discretized operator as a matrix,
where the matrix row and column numbers are identified with the DoF
numbers, and likewise the index of a vector denotes the number of the
respective degree of freedom.
</p>
<p>
For now we will only discuss how and when to number and renumber the
degrees of freedom. this needs to be done so <acronym>deal.II</acronym>
has a consistent numbering.
</p>

<h2>When to Distribute and Renumber Degrees of Freedom</h2>
<p>
Degrees of freedom <em>must always</em> be renumbered after the triangulation
has changed in any way, i.e. has been created or refined. 
<b>In particular the degrees of freedom must be distributed after the
triangulation has been created !</b>
Degrees of freedom 
can but should not be renumbered at any other time. The reason is that
sparse matrix structures and constraint matrices - to name two examples -
rely on the numbering. If you
construct a sparse matrix structure and renumber your degrees of freedom
afterwards the structure will be invalid.
</p>



<h2>How to Distribute and Renumber Degrees of Freedom</h2>
<p>
The degrees of freedom are distributed on a triangulation using the function<br>
<code>void DoFHandler&lt;dim&gt;::distribute_dofs(const FiniteElement&lt;dim&gt; &amp;)</code><br>
The argument to <code>distribute_dofs</code> is a finite element that describes
how many degrees of freedom are located on vertices, lines etc. 
(<code>FiniteElement</code> objects have much more functionality than only storing
these numbers. Parts of this functionality are discussed in the chapter on 
<a href="matrix_generation.html">matrix and vector
generation</a>.)
<code>distribute_dofs</code> works its way through the triangulation cell by
cell, starting at the coarsest level, and numbers every degree of freedom that is not yet numbered.
For non-multigrid algorithms it considers only active cells, i.e. cells 
without children.
</p>
<p class="Example">
<span class="example"><a name="ex_distribute">Example:</a></span> We show the include files, definitions
and function calls needed. Be sure to use them in their appropriate places.
This example creates a hypercube and distributes the degrees of freedom.
The finite elements used are bilinear.
</p>
<pre class="example">
<code>
#include &lt;grid/tria.h&gt;
#include &lt;dofs/dof_handler.h&gt;
#include &lt;grid/grid_generator.h&gt;
#include &lt;fe/fe_lib.lagrange.h&gt;

// first build up the triangulation
Triangulation&lt;dim&gt; triangulation;
GridGenerator::hyper_cube (triangulation,-1,1);

// you may want to refine the triangulation a bit here
...

// then associate a DoFHandler object with this triangulation...
DoFHandler&lt;dim&gt; dof_handler (tria);

// ...and distribute degrees of freedom for linear elements
FEQ1&lt;dim&gt; fe;
dof_handler.distribute_dofs(fe);
</code>
</pre>

<p>
For a number of solution algorithms this way of numbering is way below
optimal. In particular, as mentioned above, the degrees of freedom are
numbered starting on the active cells of coarser levels and going to
finer levels, but depending on how your triangulation was refined, the
order in which the cells are traversed will have no geometrical
pattern. Likewise, the distribution of DoF numbers will look mostly
random.
</p>
<p>
For some problems, it is better if the numbering of DoFs is roughly
into a certain direction, for example from inflow to outflow in
hyperbolic problems.
To achieve a kind of numbering better suited to your problem the <acronym>deal.II</acronym> 
offers the class
<code>DoFRenumbering</code> with several functions implementing
different ways of renumbering.
The methods presently available are Cuthill-McKee and reverse
Cuthill-McKee, and some other methods you will only want to ask for in
more advanced applications. The first two algorithms are usually much
better than the one used 
by <code>distribute_dofs</code>, but neither is optimal (there is no algorithm
that accomplishes optimal results within a reasonable amount of time).
Both algorithms require a good point to start numbering from (for
example one or more degrees of freedom on the inflow boundary) to
achieve good results.
</p>
<p>
The documentation of the <code>DoFRenumbering</code> gives a good
overview of how the methods mentioned above work, and how the
functions performing the re-enumerations have to be called.


<!-- Page Foot -->
<hr>
<table class="navbar">      
<tr>
  <td>
    <a href="hanging_nodes.html">Next Chapter: Hanging Nodes</a>
  </td>
  <td>
    <a href="toc.html">Back to this chapter's index</a>
  </td>
  <td>
    <a href="../index.html" target="_top">Back to the tutorial index</a>
  </td>
</tr>
</table>
<hr>
<address>
<a href="mailto:deal@iwr.uni-heidelberg.de">The deal.II group</a></address>
<p>

</p>
</body>
</html>
