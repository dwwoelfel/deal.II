<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"
   "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
  <head>
    <link href="screen.css" rel="StyleSheet" title="deal.II Homepage" media="screen">
    <link href="print.css" rel="StyleSheet" title="deal.II Homepage" media="print">
    <title>The deal.II Readme</title>
    <meta name="author" content="Wolfgang Bangerth <deal@iwr.uni-heidelberg.de>">
    <meta name="keywords" content="deal.II">
  </head>

  <body>


    <h1>Installation instructions and further information 
        on <acronym>deal.II</acronym> </h1>
	
    This document contains the following sections:
    <ul>
      <li> <a href="#prerequisites">System requirements</a>
      <li> <a href="#installation">Installation</a>
      <li> <a href="#compiler-flags">Compiler flags</a>
      <li> <a href="#external-libs">Using third-party libraries and
             subroutines</a>
      <li> <a href="#problems">Problems, questions, mailing lists</a>
      <li> <a href="#license">License</a>
    </ul>


    
    <a name="prerequisites">
    <h2>System requirements</h2>

    <p>
    At present, <acronym>deal.II</acronym> has been
    developed and tested on Unix or Unix-like systems only. It can be
    used positively on
    <ul>
      <li>Linux ELF on i386 with gcc 2.95.x, gcc 3.0.x and Intel ICC;
      <li>Sun Solaris 2.5, 2.6, and 7 on Sparc, with gcc 2.95.x
          and gcc 3.0.x; 
      <li>Sun Solaris 8 on i386, with gcc 2.95.x;
      <li>IBM AIX 4.2, with gcc 2.95.x (with some restrictions on
          the use of shared libraries).
    </ul>
    Furthermore, for the following list of systems, we have collected
    our experiences on separate pages:
    <ul>
      <li> <a href="platforms/sgi-irix.html" target="body">SGI
           IRIX64</a> with gcc 2.95.x;

      <li> <a href="platforms/dec-osf5.html" target="body">OSF1 V5.3 on
           Alpha</a> with gcc 2.95.x (the same notes probably also apply
           to Linux on DEC Alpha) and using DEC's cxx compiler version
           6.3; for older systems with OSF1 4.0 and cxx6.0 please see
	   <a href="platforms/dec-osf.html" target="body">this page</a>.

      <li> <a href="platforms/ibm_aix_xlc.html" target="body">IBM AIX
           with IBM's xlC 5.0 compiler</a>.

      <li> <a href="platforms/windows.html" target="body">Microsoft
           Windows 95/98/2000/NT</a>.
    </ul>
    </p>

    <p>
    <acronym>deal.II</acronym> uses only very few features of an
    operating system. It should therefore be rather simple to port it
    to other systems, at least with the compilers stated above. If
    your system is not on this list, take a look at the page that
    describes <a href="porting.html" target="body">porting the library
    to new systems</a>.
    </p>

    <p>
    </p>

    <p>
    In order to compile and use the <acronym>deal.II</acronym>
    libraries you need to have the following programs installed:
    <ul>
      <li> <p>
           A fairly complete C++ compiler. We use 
           <a href="http://gcc.gnu.org" target="_top">gcc2.95 or
           gcc3.0</a> but other compilers might work as well. 
	   DEC's/Compaq's cxx compiler also works. egcs1.x 
	   and older gcc versions will not work, however. Also, Sun
           Workshop C++ 5.0 will not work since it does not support
           template member functions, and IBM C Set++ 3.0 will not
           work since they only have non-ISO header file names (with
           appended .h. Version 5.0 does not work since they do not
           allow the declaration of explicit specializations and a
           larger number of other techniques that are used in the
           library. 
	   </p>

	   <p>
	   Note that we have supported egcs 1.1.x in previous releases
           of the library (up to <acronym>deal.II</acronym> 3.0.x), but
           due to some missing feature in the support of Standard C++,
           we now only support later versions of gcc for releases of
           <acronym>deal.II</acronym> after version 3.0.x. Beyond
           that, we frequently test to compile
           <acronym>deal.II</acronym> with newer gcc snapshots, so we
           expect it to work with the upcoming release of gcc 3.0.
	   </p>

	   <p>
           We are interested in writing portable C++, so if you find
           something that does not work with your compiler, we are
           likely to accept patches.
	   </p>

      <li> <p>
           Perl: any Perl 5.x version should work.
	   </p>

      <li> <p>
           Make: we use <a href="http://www.gnu.org" target="_top">GNU make</a>,
           version 3.75. We also use GNU make 3.78 which has much
           better support for parallel builds, so you may want to
           consider this version if you have a multiprocessor
           system. GNU make 3.77 had a serious flaw in the
           <code>$(wildcard ...)</code> function which prevented us
           from compiling some parts of the library (most of our
           Makefiles use a workaround, though). Other make programs
           (i.e. non-GNU) will fail to work.
	   </p>

      <li> <p>
           For debugging programs, we have found that the
	   <a href="http://www.gnu.org" target="_top">GNU
	   debugger gdb</a> is a valuable tool. However, it is noted
           that gdb 4.18 is quite broken with respect to debugging C++
           programs. A better choice is to use the older version 4.17
           which works well, or 5.0 or later. If you want to debug
           multithreaded programs, you may want to use gdb 5.0 or
           later, since gdb 4.17 did not support multiple threads too
           well.
	   </p>

      <li> <p>
           In case you want to generate the documentation from the
           header files, you only need Perl installed. The scripts
           generating the documentation are provided.
	   </p>

      <li> <p>
           Previous versions of the library supported generation of
           printable documentation. However, due to the size (around
           2000 pages) which refrains most people from printing, and
           the high cost of supporting this option, we dropped the
           possibility of printable documentation.
	   </p>

      <li> <p>
           The library generates output in formats readable by
           GNUPLOT, 
	   <a href="http://www-xdiv.lanl.gov/XCM/gmv/" target="_top">GMV
 	                              (general mesh viewer)</a>, 
	   <a href="http://www.amtec.com" target="_top">Tecplot</a>, 
           <a href="http://www.kitware.com/vtk.html"
                 target="_top">Visualization Toolkit (Vtk)</a>,
	   <a href="http://www.avs.com" target="_top">AVS Explorer</a>,
	   <a href="http://www.opendx.org" target="_top">Open DX</a>,
	   <a href="http://www.povray.org" target="_top">Povray</a>,
	   <a href="http://gaia.iwr.uni-heidelberg.de/~heuvelin/HiFlowProject/HiVision/index.html" target="_top">HiVision</a>,
           and directly to Encapsulated Postscript. GNUPLOT and a
           postscript viewer (for EPS) should be available almost
           everywhere, GMV and Open DX are freely available for most Unix
           platforms. Povray is freely available for almost all
           platforms. AVS is a commercial program available for most
           Unix flavors. Tecplot is a commercial program available for
           Windows and most Unix platforms. HiVision is available for free after
           registration.
	   </p>
    </ul>

    <p>
    In case you didn't find your favorite graphics format above it
    might be of interest that it is quite simple to add it to the list
    of supported ones (take a look at
    base/include/base/data_out_base.h and
    base/source/data_out_base.cc to see how output formats are
    implemented), as only a simple intermediate format needs to be
    converted into a graphics format, without references to cells,
    nodes, types of finite elements, and the like.
    </p>



    <a name="installation">
    <h2>Installation</h2>

    The whole library usually comes as a .tar.gz file, that is a
    tarred file archive which is compressed with gzip. After unpacking
    it with gunzip and tar (or <tt>tar xzf</tt> if you use GNU tar), you will
    find several subdirectories. First run the script 
    <pre><code>
         ./configure
    </code></pre>
    which sets some paths and finds out what compiler you
    use. ./configure supports several flags which are discussed
    further down <a href="#configuration-options">below</a>. 

    <p>

    The most important result of <code>./configure</code> is the
    creation of the file <code>common/Make.global_options</code>. This
    file contains compiler options, paths, etc which you may want to
    use in the <a href="development/index.html" target="_top">Makefiles
    of your own projects</a>. It is definitely a good
    idea to include it into your Makefile, to allow using the same
    flags for compilation between library files and the files of your
    project, and to access the paths of the library files. To find
    out about the supported flags, take a look at the file. Also,
    information about Makefiles can be found in the section on
    <a href="development/index.html" target="_top">development</a>.

    <p>

    After configuring, type `make', to obtain the following help (this
    output may change slightly over time, just try it):

    <pre><code>
    ======================================================================
    =Global Makefile for the deal.II libraries                           =
    ======================================================================
    =Possible Targets                                                    =
    =  baseg lacg: debug libraries base and lac                          =
    =  base lac: debug and optimized libraries base and lac              =
    =  1dg 2dg 3dg: (1) and deal.II debug version for specified dimension=
    =  1d 2d 3d: (2) and deal.II for specified dimension                 =
    =  contrib: make additional libraries in contrib, if there are any   =
    =  all: base, lac, 1d, 2d and 3d, contrib                            =
    =  debug: baseg, lacg, 1dg, 2dg and 3dg, contrib                     =
    =  online-doc: generate the documentation in HTML format             =
    =  TODO: create a TODO file from TODO lines in the source files      =
    =  TAGS: create a TAGS file from include and source files            =
    =  clean: removes all object files, libraries, etc in all subdirs    =
    =                                                                    =
    =The following additional parameters may be specified to make:       =
    =  PAR=-jn where n is the number of parallel processes for parallel  =
    =          builds. If you use GNU make 3.78 or higher, you can       =
    =          call 'make -jn' directly. This parameter is no more       =
    =          necessary then.                                           =
    ======================================================================
    </code></pre>

    <p>
    To execute one of the commands, type `make target-name'. Please
    note that building all libraries in debug and optimized mode
    presently takes about two hours on a Sun Ultra 450 (with 250 MHz),
    or about half an hour on a Pentium IV 1000 Mhz, so you may want to do
    this during lunchtime or night. Also, note that building all
    libraries requires 200-400 MB of free disk space (depending on
    platform).
    </p>

    <p>
    In case you have a multi-processor machine, you can call `make
    PAR=-j4 target-name' to let `make' call multiple instances of the
    compiler (in this case four). Since the make files are written in
    a way to minimize cross-dependencies, this speeds up compilation
    by about the factor given after `-j', at least if you have as many
    processors. If you have GNU make 3.78 or higher, it is simpler to
    directly call `make -j4 target-name'. Note, however, that
    parallel makes will sometimes fail when compiling the library for
    the first time (this is due to a bug in `make'); in that case,
    simply re-run `make', or run it without `-jN'.
    </p>

    <p>
    After `make' has finished, you will have two sets of
    libraries. The first consists of the files
    <ul>
      <li> <p><code>lib/libbase.a</code>: The library containing the
      code of the classes in the <code>/base</code> directory. These
      are mostly helper classes (such as output of various data in
      different data formats), and classes of general numerical
      interest (such as classes representing functions, tensors,
      etc.), but not very specifically about finite elements.
      </p>

      <li> <p><code>lib/liblac.a</code>: <code>lac</code> is the
      acronym for <i>L</i>inear <i>A</i>lgebra <i>C</i>lasses. This
      library contains classes representing vectors, matrices, sparse
      matrices, linear solvers, and the like.
      </p>

      <li> <p><code>lib/libdeal_II_2d.a</code>: This is the
      library containing all the classes representing finite element
      methods, such as grid handling, different finite elements,
      etc. Thus suffix <code>_2d</code> obviously indicates that this
      particularly library was compiled for two spatial dimensions,
      but if you told `make' to do so, there will also be libraries
      for one and three spatial dimensions.
      </p>
    </ul>
    </p>

    <p>
    For each library, there will also be another library with the
    suffix <code>.g.a</code> instead of <code>.a</code>. The
    difference between the two sets of libraries is the following:
    <ul>
      <li>
      <p>
      The <code>.g.a</code> versions contain debugging
      information. In fact the <code>.g</code> reminds us of the fact
      that gcc is called using the option <code>-g</code> to include
      debugging information into its output.
      </p>

      <p>
      Besides the debugging output the compiler puts into the output,
      the library contains a great number of assertions (presently
      about 2000) checking the validity of parameters to functions and
      internal states. These assertions have proven to be an
      invaluable mean to finding programming bugs since they will
      almost always abort your program if something goes wrong. In our
      experience, more than ninety per cent of all errors are invalid
      parameters (such as vectors having the wrong size, etc) and they
      are usually found almost instantaneously displaying the file
      name and line number of where the problem occurred.
      </p>

      <p>
      You will want to link your programs against the
      <code>.g.a</code> versions of the libraries while developing
      your programs.
      </p>

      <li>
      <p>
      The <code>.a</code> libraries do not contain debugging
      information nor the assertions. For these reasons, they are much
      smaller and your program will run significantly faster (the
      performance penalty of the <code>.g.a</code> libraries is
      between a factor of two and four, depending on which parts of
      the libraries you use). Furthermore, these libraries are
      compiled with optimization options of the compiler.
      </p>

      <p>
      You will want to link your programs against these libraries when
      they run stable and are used in production mode.
      </p>
    </ul>
    If shared libraries were built instead of static ones, then the
    suffix <code>.a</code> is replaced by <code>.so</code>
    </p>

    <p>
    Apart from the libraries, you should generate the full set of
    documentation files, by typing `make online-doc'; this takes some
    minutes since quite a lot of information is generated and
    transformed in various ways, but this way, you
    have (almost) all the documentation locally on your computer and
    need not use the <acronym>deal.II</acronym> homepage in
    Heidelberg. You can access all documentation through <a
    href="documentation.html" target="body">this page</a>. (For
    obvious reasons, the only document that you don't have locally is
    the News page, and the pages that convert the CVS logs into
    HTML. Access them through the 
    <a href="http://gaia.iwr.uni-heidelberg.de/~deal" target="_top">global 
    homepage</a>.)
    </p>


    <a name="configuration-options"></a>
    <h3>Configuration options</h3>

    <a name="choose-compiler"></a>
    <h4>Changing the compiler</h4>

    If <code>configure</code> uses a wrong compiler, there are two
    options: first, you can prepend your search path by the directory
    of the desired compiler. If you do not want to do this (and there
    are reasons), try the following: If your full compiler paths are
    <tt>mycc</tt> and <tt>myc++</tt> for your C and C++ compilers,
    respectively, type into your <tt>csh</tt>:
    <pre>
      setenv CC  mycc
      setenv CXX myc++
      ./configure
    </pre>
    or into your <tt>bash</tt>
    <pre>
      export CC=mycc
      export CXX=myc++
      ./configure
    </pre>

    <h4>Selecting optional behavior</h4>
    You can give several flags to ./configure:
    <ul>
    <li>
      <p>
      <code>--enable-shared</code>: Compile the files of deal.II into
      shared libraries, rather than statically linked
      libraries. Enabling this option saves disk space, link time and
      start-up time, so this is the default. However, some systems
      might not support shared libraries, in which case you should
      call ./configure with the parameter
      <code>--disable-shared</code>. (Since on AIX we could not get
      shared libraries right immediately, they are disabled by default
      on this system. The same applies to DEC Alpha stations running
      Linux and OSF1, and CygWin Windows systems. Probably, there is a
      simple work-around, but since we can't regularly test there, we
      did not try very hard. If anyone would like to look into this,
      we would be pleased to offer advice.)
      </p>

      <p>
      It is important to note that the actual size of the executable
      program in memory will be larger than when linked statically,
      since the dynamic linker does not remove symbols which are not
      used, in contrast to the static linker. Therefore, more main
      memory will be used when running your applications, but link
      time is significantly reduced.      
      </p>

    <li>
      <p>
      <code>--enable-multithreading</code>: This sets compiler
      variables such that the resulting program supports
      multi-threading. Basically, for this different system include
      files have to be selected (gcc option -threads) and memory
      allocation has to be made thread-safe; the latter can be done
      for the C++ standard containers by defining
      <code>-D__USE_MALLOC</code>. Note that not all parts of the
      deal.II library are fully thread-safe (though most are and
      multi-threaded programs are working well and routinely) and that
      gcc's runtime library is not thread-safe unless you configure gcc
      with <code>--enable-threads</code> and recompile it. Using a gcc
      that was not configured with this option may lead to errors in
      your threaded programs that are extremely hard to find.
      </p>

    <li>
      <p>
      <code>--with-multithreading=ACE-path</code>: enabling
      multi-threading as shown above does not enable multi-threading
      inside the library itself. However, there are several places
      where multi-threading can be used (in some parts of the graphical
      output routines, the KellyErrorEstimator class and some other
      places), and you can switch to multi-threading using this
      configure option.
      </p>

      <p>
      To support multi-threading in a cross-platform way, we use the 
      <a href="http://www.cs.wustl.edu/~schmidt/ACE.html" target="_top">ACE
      (Adaptive Communications Environment)</a> library. This needs
      to be installed separately, and the path to its installation
      directory needs to be given to this option. 
      </p>

      <p>
      In our experience, if you want to use ACE on Sun, you should
      compile it for pthreads rather than Solaris threads.
      </p>

      <p>
      Note that the multi-thread support in the library is still
      experimental. While <acronym>deal.II</acronym> runs on a variety
      of Unix systems, we presently support detection of the number of
      CPUs in your system only for Linux and Solaris.
      </p>

    <li>
      <p>
      <code>--enable-compat-blocker=...</code>: the library offers
      various functions that maintain compatibility with older
      versions of <acronym>deal.II</acronym>, for example many
      functions that assume that the mapping between unit and real
      cell is a (bi-, tri-)linear one. There are respective functions
      that take a mapping object, and the compatibility functions
      simply call these with a Q1 mapping object.
      </p>
      
      <p>
      When converting old programs, and also sometimes with new
      programs, you may want to make sure that these compatibility
      functions are not called, to ensure that the mapping taken is
      always the same. In that case, you can configure the library
      with the flag
      <code>--enable-compat-blocker=mapping</code>. After
      recompilation of the library, each access to these functions is
      blocked, and an exception is thrown.
      </p>  

      <p>
      In later versions of the library, other compatibility blockers
      will be implemented as well, as we extend the functionality of
      the library.
      </p>
    </ul>

    <p>

    Please note that running ./configure stores the paths to some
    programs, such as the compilers or the Perl interpreter. The
    compiler which will be used when compiling the library (or your
    own application) is therefore selected at the time of
    configuration and independent of the present setting of your $PATH
    environment value. The reason for this is that presently there are
    still too many incompatibilities between different versions of
    compilers and that compiling different parts of programs with
    different compilers often leads to hard-to-find problems. By
    storing the absolute paths of compilers, we can at least catch
    those problems where different compiler revisions are located in
    different directories.

    <p>

    If you want to use a new compiler version, you will therefore have
    to re-run ./configure with the new compiler being in the $PATH
    environment variable.

    <p>

    It is in general a good idea to run `make clean'
    before re-configuring.



    <a name="compiler-flags">
    <h4>Compiler flags</h4>

    <p>
    Since the ISO C++ standard is still quite new and compilers still
    change a lot, you might need to provide special options for the
    compiler. We have tried to automatize this process using the
    ./configure script at least for the gcc compilers we use. If you need
    additional flags, try the following two ways:
    </p>

    <ul>
    <li> <p>
    Set environment variables before configuring. If you want to add
    a flag to produce <code>gprof</code> output, for instance, configure
    the package using the following command sequence:
    <pre>
      setenv CXXFLAGS -pg
      setenv LDFLAGS -pg
      configure &lt;configure-options&gt;
    </pre>
    These are the commands for <tt>csh</tt>. They have to be changed
    accordingly for <tt>bash</tt>
    </p>

    <li> 
    <p>
    If that does not work, edit the file
    common/Make.global_options.in and rerun ./configure in the
    top-level directory, or change the file 
    common/Make.global_options, which is what ./configure generates
    out of common/Make.global_options.in.
    </p>
    </ul>

    <p>
    The first method is preferred, since it will be easier to
    incorporate it into the configuration script later. Furthermore,
    your version of <acronym>deal.II</acronym> will not be changed
    from the original.
    </p>

    <p>
    We would like to hear about necessary or useful modifications so
    that we can include them into the distribution.
    </p>


    <a name="external-libs">
    <h2>Using third-party libraries and subroutines</h2>

    <p>
    <acronym>deal.II</acronym> is able to interface some external 
    libraries and subroutines for special purposes inside the library
    or application programs built on
    <acronym>deal.II</acronym>. Presently supported are the following:

    <ul>
      <li>
      <p>
      <a href="http://www.cs.wustl.edu/~schmidt/ACE.html" target="_top">ACE
      (Adaptive Communications Environment)</a>: This library is used
      to support multithreading in a cross-platform way. It also
      enables programs to use interprocess communication and many
      other related services using a platform independent
      interface. On how to enable using this library, see the section on
      <a href="#configuration-options">Configuration Options</a> above.
      </p>

      <li>
      <p>
      It is also possible to use some subroutines from the
      <a href="http://www.cse.clrc.ac.uk/Activity/HSL"
      target="_top">Harwell Subroutine Library (HSL)</a> to make use
      of some sparse direct solvers. For a description of how to
      include these functions, see
      <a href="external-libs/hsl.html" target="body">this page</a>.
      </p>
    </ul>
    </p>


    <a name="problems">
    <h2>Problems, questions, mailing lists</h2>

    Some information beyond what is covered in the documentation of
    the library may be found on the
    <a href="http://gaia.iwr.uni-heidelberg.de/~deal" target="_top">homepage of
    <acronym>deal.II</acronym></a>, or in the
    <a href="faq.html" target="body">Frequently Asked Questions</a> section.
    If you don't find anything there,
    feel free to ask if you have any problems with deal.II. If a
    question is of general interest, you may want to use our mailing list,
    which can be reached at
    <a href="mail.html" target="body"><b>deal</b> at <b>iwr.uni-heidelberg.de</b></a> 
    and of which
    <a href="http://gaia.iwr.uni-heidelberg.de/~deal/mail/maillist.html" target="body">
    previous mails</a> are also archived online.

    <p>
    
    You can <B>subscribe</B> to this list by writing email to <a
    href="mailto:majordomo@iwr.uni-heidelberg.de"><b>majordomo</b>@<b>iwr.uni-heidelberg.de</b></a>
    with the text (not in the subject!)
    <pre>
      subscribe deal
    </pre>
    or (if you have to subscribe from a different email address)
    <pre>
      subscribe deal your_address@wherever
    </pre>
    The list server also understands the command <TT>help</TT> given
    on a line by itself.
  
    <p>

    For specific problems, send email to either
    <a href="mailto:wolfgang.bangerth@iwr.uni-heidelberg.de">Wolfgang Bangerth</a> or
    <a href="mailto:kanschat@iwr.uni-heidelberg.de">Guido Kanschat</a>.

    <p>

    We are interested in any feedback, whether positive or negative,
    in order to determine the directions of future work on the
    library. We are also very much interested in incorporating any
    work and bug fixes by third parties into the library. Of course,
    you will be credited for this on our home page.



    <a name="license">
    <h2>License</h2>

    <p>
    We have placed <acronym>deal.II</acronym> under an <a
    href="http://www.opensource.org" target="_top">Open Source</a>
    license, which allows you to use the library free of charge for
    non-commercial purposes. You are guaranteed full access to the
    source code and are encouraged to help in the further development
    of the library.  Follow <a href="license.html" target="body">this
    link</a> to read the full text of the license,
    </p>

    <p>
    The basics of the license are in short:
    <ul>
      <li>
        The library comes free of charge for non-commercial users, but
         we keep a copyright in it. We will grant everyone access to
         the library and its source code, provided they keep to the
         <a href="license.html" target="body">license</a>.

      <li>
        The libraries may not be stripped of our copyright and shall
        not be used in commercial projects without our written prior
        consent.

      <li>
        Scientific publications presenting results obtained with these
        libraries should acknowledge the use of the library and name
        its principle authors (at present Wolfgang Bangerth, Ralf
        Hartmann and Guido Kanschat). Citation of the reports named on
        the homepage is appreciated.
    </ul>

    Note that since our institute is evaluated at regular intervals,
    we are interested in documenting the use of the programs and
    libraries we create. We are therefore interested in collecting
    publications with results obtained with the aid of these libraries
    and would therefore like to ask you to drop us a note about every
    such publication. Your publication will then be listed on the
    project homepage.


    <hr>
    
    <address>
      <a href="mail.html" target="body">The deal.II mailing list</a>
      $Date$
    </address>
  </body>
</html>
