<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-1 (1.68)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Assembling vector-valued problems: The complicated case</TITLE>
<META NAME="description" CONTENT="Assembling vector-valued problems: The complicated case">
<META NAME="keywords" CONTENT="assemble">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="assemble.css">

<LINK REL="next" HREF="node15.html">
<LINK REL="previous" HREF="node7.html">
<LINK REL="up" HREF="assemble.html">
<LINK REL="next" HREF="node11.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html118"
  HREF="node11.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="../deal.II-paper/next_motif.gif"></A> 
<A NAME="tex2html116"
  HREF="assemble.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="../deal.II-paper/up_motif.gif"></A> 
<A NAME="tex2html110"
  HREF="node9.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="../deal.II-paper/previous_motif.gif"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html119"
  HREF="node11.html">Getting information about shape</A>
<B> Up:</B> <A NAME="tex2html117"
  HREF="assemble.html">assemble</A>
<B> Previous:</B> <A NAME="tex2html111"
  HREF="node9.html">The Stokes equations</A>
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00060000000000000000">
Assembling vector-valued problems: The complicated case</A>
</H1>

<P>
The more complicated case is when more than one component of a vector-valued
shape function is non-zero, i.e. the representation
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="248" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="img77.gif"
 ALT="$\displaystyle \Phi_i(\vec x) = \left( 0, \dots, 0, \varphi_i(\vec x), 0, \ldots, 0\right)^T,$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;&nbsp;&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
does not hold any more. The usual case where this happens is when shape
functions have to satisfy certain constraints, such as that they should have
zero divergence or curl, or when the normal fluxes at some points, e.g. the
face centers, are the degrees of freedom: 
<!-- MATH
 $\vec n\cdot \Phi_i(x_a) = \delta_{ia}$
 -->
<IMG
 WIDTH="112" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img95.gif"
 ALT="$ \vec n\cdot \Phi_i(x_a) = \delta_{ia}$">. In this case, the individual
components of a shape function are no more independent, and thus cannot be
chosen such that only one component is non-zero.

<P>
What happens in this case? First, the function
<TT>FiniteElement::system_to_component_index</TT> does not make much sense
any more, since a shape function <IMG
 WIDTH="21" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img76.gif"
 ALT="$ \Phi_i$"> cannot be associated with only one
vector component any more. Calling this function for basis functions <IMG
 WIDTH="21" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img76.gif"
 ALT="$ \Phi_i$">
that are not restricted to only one non-zero component will thus yield an
exception being thrown.

<P>
Second, the functions <TT>FEValues::shape_value</TT> and
<TT>FEValues::shape_grad</TT> returning the values and gradients of the only
non-zero component of a shape function at a quadrature point cannot work any
more, since there are now more than only one non-zero components for some or
all values of <IMG
 WIDTH="10" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img33.gif"
 ALT="$ i$">. For those shape function for which this holds, you will
again get an exception upon calling these functions.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><UL>
<LI><A NAME="tex2html120"
  HREF="node11.html">Getting information about shape functions</A>
<LI><A NAME="tex2html121"
  HREF="node12.html">Evaluating shape functions</A>
</UL>
<BR>
<LI><A NAME="tex2html122"
  HREF="node13.html">The elastic equations</A>
<LI><A NAME="tex2html123"
  HREF="node14.html">The Stokes equations</A>
</UL>
<!--End of Table of Child-Links-->
<HR>
<!--Navigation Panel-->
<A NAME="tex2html118"
  HREF="node11.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="../deal.II-paper/next_motif.gif"></A> 
<A NAME="tex2html116"
  HREF="assemble.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="../deal.II-paper/up_motif.gif"></A> 
<A NAME="tex2html110"
  HREF="node9.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="../deal.II-paper/previous_motif.gif"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html119"
  HREF="node11.html">Getting information about shape</A>
<B> Up:</B> <A NAME="tex2html117"
  HREF="assemble.html">assemble</A>
<B> Previous:</B> <A NAME="tex2html111"
  HREF="node9.html">The Stokes equations</A>
<!--End of Navigation Panel-->
<ADDRESS>
Wolfgang Bangerth
2002-06-14
</ADDRESS>
</BODY>
</HTML>
