<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-1 (1.68)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Assembling vector-valued problems: The simple case</TITLE>
<META NAME="description" CONTENT="Assembling vector-valued problems: The simple case">
<META NAME="keywords" CONTENT="assemble">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="assemble.css">

<LINK REL="next" HREF="node10.html">
<LINK REL="previous" HREF="node4.html">
<LINK REL="up" HREF="assemble.html">
<LINK REL="next" HREF="node8.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html88"
  HREF="node8.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="../deal.II-paper/next_motif.gif"></A> 
<A NAME="tex2html86"
  HREF="assemble.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="../deal.II-paper/up_motif.gif"></A> 
<A NAME="tex2html80"
  HREF="node6.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="../deal.II-paper/previous_motif.gif"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html89"
  HREF="node8.html">The elastic equations</A>
<B> Up:</B> <A NAME="tex2html87"
  HREF="assemble.html">assemble</A>
<B> Previous:</B> <A NAME="tex2html81"
  HREF="node6.html">The Stokes equations</A>
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00050000000000000000">
Assembling vector-valued problems: The simple case</A>
</H1>

<P>
The simple case in assembling vector-valued problems is when the (also
vector-valued) shape functions are chosen such that only one component in the
vector is nonzero. This is usually the case, if we choose the shape functions
to be the outer product of scalar shape functions, such as independent
bilinear ansatz spaces for each component of a finite element space.

<P>
In this case, each shape function <IMG
 WIDTH="21" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img76.gif"
 ALT="$ \Phi_i$"> has the representation
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="248" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="img77.gif"
 ALT="$\displaystyle \Phi_i(\vec x) = \left( 0, \dots, 0, \varphi_i(\vec x), 0, \ldots, 0\right)^T,$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;&nbsp;&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <IMG
 WIDTH="21" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img76.gif"
 ALT="$ \Phi_i$"> is the vector-valued shape function, and <IMG
 WIDTH="20" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img78.gif"
 ALT="$ \varphi_i$"> its
only non-zero component. Let us denote by <IMG
 WIDTH="29" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img79.gif"
 ALT="$ c(i)$"> the index of this non-zero
component, then <IMG
 WIDTH="21" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img76.gif"
 ALT="$ \Phi_i$"> can also be written as 
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="159" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img80.gif"
 ALT="$\displaystyle \left(\Phi_i(\vec x)\right)_l = \varphi_i(\vec x) \delta_{c(i),l},$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;&nbsp;&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
with the Kronecker delta function <!-- MATH
 $\delta_{jk}$
 -->
<IMG
 WIDTH="25" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img81.gif"
 ALT="$ \delta_{jk}$">.

<P>
With this simple form, the cell matrix on cell <IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img20.gif"
 ALT="$ K$"> has a simple form:
<P></P>
<DIV ALIGN="CENTER"><TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="418" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img82.gif"
 ALT="$\displaystyle A^K_{ij} = a_K(\Phi_i,\Phi_j) = \left(\Phi_i \mid Q \mid \Phi_j \right)_K = \left(\varphi_i \mid Q_{c(i),c(j)} \mid \varphi_j \right)_K.$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
&nbsp;&nbsp;&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
Thus, in assembling the local cell matrices, we only have to determine the
single components in which the two shape functions are non-zero, and 
pick one element from the matrix <IMG
 WIDTH="17" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img61.gif"
 ALT="$ Q$"> to assemble each entry of the cell
matrix with the help of the values of the functions <IMG
 WIDTH="20" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img78.gif"
 ALT="$ \varphi_i$"> at the
quadrature points. Here, it comes handy that we have written the operator as a
matrix operator <IMG
 WIDTH="17" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img61.gif"
 ALT="$ Q$">, since this makes it very clear how shape functions <IMG
 WIDTH="10" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img33.gif"
 ALT="$ i$">
and <IMG
 WIDTH="12" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img83.gif"
 ALT="$ j$"> couple: if <!-- MATH
 $Q_{c(i),c(j)}$
 -->
<IMG
 WIDTH="63" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img84.gif"
 ALT="$ Q_{c(i),c(j)}$"> is zero, then they do not couple at all for
this operator. Otherwise, it is easily visible which derivative acts on which
shape function for this combination of shape functions.

<P>
In <TT>deal.II</TT>, these two actions mentioned above (getting the non-zero
component of a shape function, and the value of this component at a given
quadrature point) are done as follows:

<UL>
<LI><I>Determining the non-zero component:</I> Given the shape function
  with number <IMG
 WIDTH="10" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img33.gif"
 ALT="$ i$"> (i.e. its index local to the degrees of freedom on the
  present cell), its only non-zero component is obtained by the function call 
<PRE>
  const unsigned int nonzero_component_i
     = fe.system_to_component_index(i).first;
</PRE>
  The <TT>FiniteElement::system_to_component_index</TT> returns a pair of
  numbers for each index <!-- MATH
 $0\le i < N_K$
 -->
<IMG
 WIDTH="85" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img85.gif"
 ALT="$ 0\le i &lt; N_K$">, the first of which denotes the only
  non-zero component of the shape function <IMG
 WIDTH="10" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img33.gif"
 ALT="$ i$">. Since for the case described
  in this section, the individual components of the vector-valued finite
  element are independent, we consider each component as a set of scalar shape
  functions; the second number of the pair returned by the function then
  denotes the index of the shape function <IMG
 WIDTH="20" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img78.gif"
 ALT="$ \varphi_i$"> within the shape
  functions corresponding to this component.

<P>
If, for example, our finite element in use is a <!-- MATH
 $Q^2/Q^2/Q^1$
 -->
<IMG
 WIDTH="79" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img86.gif"
 ALT="$ Q^2/Q^2/Q^1$"> combination
  (for example for 2d flow computations: bi-quadratic ansatz functions for the
  velocities, bi-linear for the pressure), then we have a total of 22 shape
  functions (9+9+4). For each <!-- MATH
 $0\le i < 22$
 -->
<IMG
 WIDTH="76" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img87.gif"
 ALT="$ 0\le i &lt; 22$">, the first part of the pair
  returned by the function described above, <IMG
 WIDTH="29" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img79.gif"
 ALT="$ c(i)$">, may then either be 0, 1,
  or 2, denoting the three possible components of the finite element. If
  <IMG
 WIDTH="29" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img79.gif"
 ALT="$ c(i)$"> is either 0 or 1, then the component to which the shape function <IMG
 WIDTH="10" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img33.gif"
 ALT="$ i$">
  belongs is a bi-quadratic one, and the second index is between 0 and <IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img88.gif"
 ALT="$ 8$">
  (inclusive) as the <IMG
 WIDTH="24" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="img89.gif"
 ALT="$ Q^2$"> element has 9 shape functions. If <IMG
 WIDTH="70" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img90.gif"
 ALT="$ c(i)==2$">, then
  the second part is between 0 and 3 (inclusive).

<P>
</LI>
<LI><I>Getting the value of <!-- MATH
 $\varphi_i(\vec x_q)$
 -->
<IMG
 WIDTH="49" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img91.gif"
 ALT="$ \varphi_i(\vec x_q)$">:</I> Since only one
  component of <IMG
 WIDTH="21" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img76.gif"
 ALT="$ \Phi_i$"> is non-zero, we can use the same function as before,
  i.e. <TT>FEValues::shape_value(i,q)</TT>, which in the scalar case returned
  the value of shape function <IMG
 WIDTH="10" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img33.gif"
 ALT="$ i$"> at quadrature point <IMG
 WIDTH="12" HEIGHT="28" ALIGN="MIDDLE" BORDER="0"
 SRC="img92.gif"
 ALT="$ q$">. Likewise, the 
  <TT>FEValues::shape_grad(i,q)</TT> function returns the gradient of this
  particular component.

<P>
In other words, whether the finite element is scalar or not, the two
  indicated functions return value and gradient of the only non-zero component
  of a shape function. If the finite element is scalar, then it is of course
  clear which component this is (since there <IMG
 WIDTH="70" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img93.gif"
 ALT="$ c(i)==0$"> for all valid indices
  <IMG
 WIDTH="10" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img33.gif"
 ALT="$ i$">), in the vector-valued case, it is component <IMG
 WIDTH="29" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img79.gif"
 ALT="$ c(i)$">.
</LI>
</UL>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html90"
  HREF="node8.html">The elastic equations</A>
<LI><A NAME="tex2html91"
  HREF="node9.html">The Stokes equations</A>
</UL>
<!--End of Table of Child-Links-->
<HR>
<!--Navigation Panel-->
<A NAME="tex2html88"
  HREF="node8.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="../deal.II-paper/next_motif.gif"></A> 
<A NAME="tex2html86"
  HREF="assemble.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="../deal.II-paper/up_motif.gif"></A> 
<A NAME="tex2html80"
  HREF="node6.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="../deal.II-paper/previous_motif.gif"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html89"
  HREF="node8.html">The elastic equations</A>
<B> Up:</B> <A NAME="tex2html87"
  HREF="assemble.html">assemble</A>
<B> Previous:</B> <A NAME="tex2html81"
  HREF="node6.html">The Stokes equations</A>
<!--End of Navigation Panel-->
<ADDRESS>
Wolfgang Bangerth
2002-06-14
</ADDRESS>
</BODY>
</HTML>
