<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
       "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>The deal.II Readme on interfacing to PETSc and Trilinos</title>
  <link href="screen.css" rel="StyleSheet">
  <meta name="author" content="the deal.II authors <authors @ dealii.org>">
  <meta name="copyright" content="Copyright (C) 2008 by the deal.II authors">
  <meta name="date" content="$Date: 2008-10-14 05:36:48 -0500 (Tue, 14 Oct 2008) $">
  <meta name="svn_id" content="$Id: readme.html 17202 2008-10-14 10:36:48Z heister $">
  <meta name="keywords" content="deal.II">
</head>

<body>


    <h1>Interfacing <acronym>deal.II</acronym> to PETSc and Trilinos</h1>

    <h3>About PETSc, Trilinos, and the <acronym>deal.II</acronym>
    interfaces</h3>

    <p>    
      <acronym>deal.II</acronym> can interface to the <a
      href="http://www.mcs.anl.gov/petsc/" target="_top">PETSc</a> and
      <a href="http://trilinos.sandia.gov" target="_top">Trilinos</a> software
      libraries. Both of these libraries provide lots of functions for linear
      algebra, among other things, for example implementations of a variety of
      linear solvers, as well as various different sparse and dense matrix and
      vector formats. Trilinos also has many subpackages that deal with
      problems that go far beyond linear algebra, for example nonlinear
      solvers, automatic differentiation packages, uncertainty propagation
      engines, etc. Of particular interest to deal.II is their ability to
      provide this functionality both on sequential and parallel (using MPI)
      computers. PETSc is written in C; Trilinos is written in C++ and can be
      considered to be a more modern version of PETSc though both packages are
      under continuing development at their respective national laboratories.
      </p>

      <p>
      <acronym>deal.II</acronym> has wrapper classes to the linear algebra
      parts of both packages that provide almost the
      same interfaces as the built-in <acronym>deal.II</acronym> linear
      algebra classes. We use these interfaces for parallel computations based
      on MPI since the native deal.II linear algebra classes lack this ability.
      </p>


      <h3>Configuring the interfaces to PETSc and Trilinos</h3>

      <p>
      The use of PETSc and Trilinos is optional. To use the wrapper classes,
      you first have to install these packages and
      point <acronym>deal.II</acronym>'s <code>./configure</code> to the
      installation directories. This happens in similar ways for the two
      packages: 
      </p>


      <h6>PETSc</h6>
      
      <p>
      PETSc usually requires you to set the
      environment variables <code>PETSC_DIR</code> and <code>PETSC_ARCH</code>
      to a path to PETSc and denoting the architecture for which PETSc is
      compiled. If these environment variables are set, then
      <acronym>deal.II</acronym> will pick them up during configuration, and
      store them. It will then also recognize that PETSc shall be used, and
      enable the wrapper classes. 
      </p>

      <p>
      Alternatively, the <code>--with-petsc=DIR</code> and
      <code>--with-petsc-arch=ARCH</code> switches to
      <code>./configure</code> can be used to override the values
      of <code>PETSC_DIR</code> and <code>PETSC_ARCH</code> or if these
      environment variables are not set at all. If you do have a PETSc installation
      and have set the <code>PETSC_DIR</code> and
      <code>PETSC_ARCH</code> environment variables but do not wish
      <acronym>deal.II</acronym> to be configured for PETSc use, you
      should specify <code>--with-petsc=no</code> as a flag during
      configuration. 
      </p>

      <p>
      Note that in order to use PETSc with <acronym>deal.II</acronym>
      with the current version of <acronym>deal.II</acronym>, you
      need to have at least PETSc version 2.3.1
      installed. <acronym>deal.II</acronym> version 6.0 has been
      tested up to PETSc release 2.3.3-p4.
      </p>

      <p>
      Installing both PETSc and deal.II together can be a bit of a challenge. A
      good summary of the relevant steps can be found on the <a
      href="http://www-dimat.unipv.it/heltai/wikideal/index.php/Deal.II_Questions_and_Answers"
      target="_top">Frequently Asked Questions page</a>, as well as
      <a
      href="http://ganymed.iwr.uni-heidelberg.de/pipermail/dealii/2007/001820.html">in
      this posting to the mailing list</a>. 
      </p>


      <h6>Trilinos</h6>

      <p>
      As above, set the <code>TRILINOS_DIR</code>
      environment variable to the path to an existing Trilinos installation,
      or use the <code>--with-trilinos=/path/to/trilinos</code> switch of
      the deal.II <code>./configure</code> script. It should point to the path
      of which the include and lib directories are subdirs. The Trilinos 
      installation needs to provide the same kind of libraries that 
      <acronym>deal.II</acronym> is configured for, i.e. if you want deal.II
      to use shared libraries, then Trilinos needs to use shared libraries as
      well.
      </p>

      <p>
      <acronym>deal.II</acronym> and its tutorial programs use several of the
      Trilinos sub-packages. Configuring Trilinos with a command
      like the following should do the trick:
      <code>
      <pre>
../configure --enable-shared \
      --with-cflags=-fPIC --with-cxxflags=-fPIC --with-fflags=-fPIC \
      --enable-thyra --enable-stratimikos --enable-rtop --enable-teuchos \
      --enable-sacado --enable-ml --enable-ifpack --enable-epetra \
      --enable-belos --enable-aztecoo --enable-amesos \
      --prefix=/home/bangerth/bin/trilinos-9.0.1
      </pre>
      </code>
      </p>


      <h3>Configuring for installed Trilinos packages</h3>

      <p>
	The above scheme works if Trilinos is installed in its own directory
	and header and library files are in subdirectories of the directory
	given to <code>--with-trilinos</code>. This scheme doesn't work, 
	however, if Trilinos has been installed as a regular package on a
	system, for example into the <code>/usr</code> or <code>/opt</code>
	directories. 
      </p>

      <p>
	In that case, paths to include and library files may be specified
	separately using the <code>--with-trilinos-include</code>
	and <code>--with-trilinos-libs</code> switches 
	to <code>./configure</code>. Alternatively, this information can also
	be passed to the configuration script by setting the environment
	variables <code>TRILINOS_INCDIR, TRILINOS_LIBDIR</code>.
      </p>

    <hr>
    
    <address>
      <a href="mail.html" target="body">The deal.II mailing list</a>
      $Date: 2008-10-14 05:36:48 -0500 (Tue, 14 Oct 2008) $
    </address>
  </body>
</html>
