<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"
   "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
  <head>
    <link href="../../screen.css" rel="StyleSheet" title="deal.II Homepage" media="screen">
    <link href="../../print.css" rel="StyleSheet" title="deal.II Homepage" media="print">
    <title>The deal.II news page</title>
    <meta name="author" content="Wolfgang Bangerth, Guido Kanschat, and others">
    <meta name="keywords" content="deal.II"></head>

<body>


<h2>Changes after Version 3.1</h2>

This is a quite extensive list of changes made after the release of 
<acronym>deal.II</acronym> version 3.1. It is subdivided into changes
made to the three sub-libraries <a href="#base">base</a>, 
<a href="#lac">lac</a>, and <a href="#deal.II">deal.II</a>, as well as
changes to the <a href="#general">general infrastructure,
documentation, etc</a>.



<a name="general"></a>
<h3>General</h3>

<ol>
  <li> <p>
       Fixed: the program that generated HTML from the example
       programs was broken on some platforms for reasons beyond our
       knowledge. This is now fixed.
       <br>
       (Roger Young, WB 2001/03/22)
       </p>

  <li> <p>
       Improved: libraries are now all in a subdirectory lib in the
       <acronym>deal.II</acronym> home directory. It is now easy to
       make this directory a link to put the libraries on a faster
       disk.
       <br>
       (GK 2001/03/14)
       </p>

  <li> <a name="new_fe_mapping_design"></a>
       <i> New Design of <code class="class">FiniteElements</code>
       and <code class="class">Mappings</code></i>
              
       <p>
       New: The finite element
       classes have been redesigned from scratch to allow also
       elements that depend on the actual cell shape, like
       Raviart-Thomas, BDM or edge elements. We have implemented
       continuous Lagrange elements up to degree four and discontinous
       Lagrange elements up to degree 10. They can be easily extended
       to higher degree.
       </p>

       <p> 
       Furthermore we have totally reimplemented the mapping
       between unit and real cell.  In future we won't be restricted
       to Q<sub>1</sub> mapping any more, but we will have
       Q<sub>p</sub> mappings of arbitrary degree p. Presently
       implemented are mappings up to degree 10 in 2d, and degree
       three in 3d. This allows to approximate curved boundaries not
       only by straight lines (linear approximation) but also by
       quadratic, cubic, etc approximation. The finite elements will
       be able to be combined with arbitrary mappings. So in future we
       can use subparametric, iso- as well as superparametric
       elements.
       </p>

       <p>
       The new implementation uses a totally new structure of
       communication between <code class="class">FEValues</code>, the
       <code class="class">FiniteElements</code> and the <code
       class="class">Mappings</code>. Despite of this, the new
       structure will almost not be 'visible' to the user of
       <acronym>deal.II</acronym> as we tried to retain the interface
       to the user (mainly that of <code
       class="class">FEValues</code>) as far as possible.
       </p>

       <p>
       Together with this new design comes a reduction of 25000(!)
       lines of <acronym>deal.II</acronym> code. This elimination
       mainly affected code that previously was machine generated
       (e.g. by maple). In view of almost unchanged execution times of
       applications, the faster compilation and additional
       functionality constitutes a significant improvement of
       <acronym>deal.II</acronym>. Results produced by the new code
       match those of the old design up to machine precision.
       <br>
       (RH & GK 2001/03/13)
       </p>

  <li> <p>
       New: There is now some support to include and use routines from the 
       <a href="http://www.cse.clrc.ac.uk/Activity/HSL" 
       target="_top">Harwell Subroutine Library</a>.
       (See the <a href="../../readme.html#external-libs" target="body">ReadMe</a>
       file for more information on installation of HSL
       subroutines.)
       <br>
       (WB 2001/01/30)
       </p>

  <li> <p>
       New: The <code>./configure</code> script now checks for the
       existence of a Fortran 77 compiler, and sets its path, some
       compiler flags and the libraries to be linked in when mixing
       C++ and F77 in some variables in the file
       <code>common/Make.global_options</code> (see also
       <a href="../../development/makefiles.html" target="body">this
       page</a>).
       <br>
       (WB 2000/12/30)
       </p>
</ol>



<a name="base"></a>
<h3>base</h3>

<ol>
  <li> <p>
       Changed: The <code class="class">LogStream</code> class was
       changed such that it understand the usual <code
       class="member">std::endl</code> manipulator instead of the
       special one needed previously. There is therefore no more need
       to write <code class="member">std::endl</code> at some places
       and <code class="member">endl</code> at others. The special
       function <code class="member">endl</code> has gone.
       <br>
       (WB 2001/03/28)
       </p>

  <li> <p>
       New: The <code class="class">Threads</code> now has a barrier
       class in order to synchronise multiple threads. In
       multithreaded mode, this is an alias to the <code
       class="class">ACE_Barrier</code> class of the ACE library, if
       deal.II is not configured for multithreading, then the class is
       a dummy class that does nothing.
       <br>
       (WB 2001/03/19)
       </p>

  <li> <p>
       New: We now support the output format of the <a
       href="http://www.kitware.com/vtk.html"
       target="_top">Visualization Toolkit (Vtk)</a> from the <code
       class="class">DataOutBase</code> class and all derived classes.
       <br>
       (WB 2001/03/19)
       </p>

  <li> <p>
       New: The class <code
       class="class">TensorProductPolynomials&lt;dim&gt;</code>
       performs the tensor product of 1d polynomials, computes its
       values, its first and second derivatives. If <code>n</code>
       polynomials are given to the constructor of this class, it
       constructs <code>n<sup>dim</sup></code> tensor product
       polynomials.
       <br>
       (RH 2001/03/14)
       </p>

  <li> <p>
       New: <code class="class">LagrangeEquidistant</code> is a new
       class derived from <code class="class">Polynomial</code>
       providing the 1d Lagrange interpolation of degree
       <code>n</code> of <code>n+1</code> equidistant support points
       in <code>[0,1]</code>. It is implemented up to degree 10.
       This class is used for the implementation of the continuous and
       discontinuous Lagrange elements.
       <br>
       (RH 2001/03/14)
       </p>

  <li> <p>
       New: The new <code class="class">Polynomial</code> class can
       be used as base class for all 1d polynomials. It stores the
       coefficients of the polynomial and uses the Horner scheme to
       evaluate values and all derivates.
       <br>
       (RH 2001/03/14)
       </p>

  <li> <p>
       New: function <code>contract</code> for two arguments of
       <code class="class">Tensor&lt;1,dim&gt;</code>
       <br>
       (GK 2001/03/05)
       </p>

  <li> <p> New: <code class="class">Logstream</code>.<code
       class="member">log_time_differences (bool)</code> makes <code
       class="class">Logstream</code> print the time since the last
       log line instead of accumulated time since program start.
       <br>
       (GK 2001/03/05)
       </p>


  <li> <p> Fix: <code class="class">Logstream</code>.<code
       class="member">pop()</code> does not perform anything on empty
       stacks.
       <br>
       (GK 2001/03/05)
       </p>


  <li> <p>
       Changed: Sort the quadrature points of each <code
       class="class">Quadrature&lt;1&gt;</code> in ascending order. This
       actually changed the order of the points of only <code
       class="class">QGauss4</code> and <code
       class="class">QGauss5</code>.
       <br>
       (Ralf Hartmann 2001/01/22)
       </p>

  <li> <p>
       New: function <code>contract</code> for two arguments of
       <code class="class">Tensor&lt;1,dim&gt;</code>
       <br>
       (GK 2001/01/15)
       </p>
</ol>



<a name="lac"></a>
<h3>lac</h3>

<ol>
  <li> <p> Changed: Solver functions <code class="member">solve</code>
       are void now. If the solver has not converged within the
       maximum number of iterations, it throws an exception of type
       <code class="class">ExcNoConvergence</code>.
       <br>
       (GK 2001/03/29)
       </p>

  <li> <p> 
       New: The functions <code class="class">FullMatrix</code>::<code
       class="member">mmult</code> and <code
       class="member">Tmmult</code> now have an additional
       <code>adding</code> argument. If this flag is
       <code>true</code>, the matrix-matrix product is added to the
       resulting matrix; if <code>false</code>, the resulting matrix
       is set to (overwritten by) the matrix-matrix product. The
       latter is the behaviour these functions had before. Hence the
       default value is set to be <code>false</code> to ensure
       backward compatibility.
       <br>
       (RH 2001/03/29)
       </p>

  <li> <p>
       New: class <code class="class">SchurMatrix</code> implements
       a Schur complement for block matrices. It provides matrix-vector
       multiplication suitable for iterative methods as well as pre- and
       post-processing of right hand side and slution, respectively. 
       <br>
       (GK 2001/03/22)
       </p>

  <li> <p>
       Removed: The explicite instantiations of <code
       class="class">SparseMatrix&lt;long double&gt;</code> are
       removed as a prerelease of gcc3.0 fails to compile it. A user
       of <code class="class">SparseMatrix&lt;long double&gt;</code>
       needs now to include
       <code>lac/include/lac/sparse_matrix.templates.h</code> into his
       source file and to use an appropriate compiler, e.g. gcc2.95.2 or
       a future version of gcc3.0 (that will then hopefully be fixed).
       <br>
       (RH 2001/03/14)
       </p>
  
  <li> <p> 
       New: class <code
       class="class">BlockMatrixArray&lt;MATRIX&gt;</code> implements
       a block matrix based on an array of matrix pointers. Since this
       array may be incomplete, no direct access to entries is
       allowed. Matrix blocks may be scaled and transposed.
       <br>
       (GK 2001/02/13)
       </p>

  <li> <p>
       New: There is now some support to include and use routines from the 
       <a href="http://www.cse.clrc.ac.uk/Activity/HSL" 
       target="_top">Harwell Subroutine Library</a>, and support
       classes 
       <code class="class">SparseDirectMA27</code> and
       <code class="class">SparseDirectMA47</code>
       for the sparse direct solvers MA27 and MA47.
       (See the <a href="../../readme.html#external-libs" target="body">ReadMe</a>
       file for more information on installation of HSL
       subroutines.)
       <br>
       (WB 2001/01/30)
       </p>
</ol>



<a name="deal.II"></a>
<h3>deal.II</h3>

<ol>
  <li> <p>
       Removed: the <code class="class">ProblemBase</code> class,
       which has been deprecated since before the release of 
       <acronym>deal.II</acronym> 3.0 has finally been removed. The
       same applied for the classes
       <code class="class">Assembler</code>,
       <code class="class">Equation</code>,
       <code class="class">MassMatrix</code>, and
       <code class="class">LaplaceMatrix</code>.
       <br>
       (WB 2001/03/27)
       </p>

  <li> <p>
       New: There is now a class <code class="class">MappingC1</code>
       that implements a continously differentiable C<sup>1</sup>
       mapping of the boundary by using a cubic mapping with
       continuous derivatives at cell boundaries. The class presently
       only implements something for 2d and 1d (where it does nothing).
       <br>
       (WB 2001/03/27)
       </p>

  <li> <p>
       New: The static <code class="member">interpolate</code>, <code
       class="member">create_right_hand_side</code>, <code
       class="member">interpolate_boundary_values</code>, <code
       class="member">integrate_difference</code> and <code
       class="member">compute_mean_value</code> member functions of
       the class <code class="class">VectorTools</code> are extended
       to work on arbitrary mappings. All these functions now take a
       <code class="class">Mapping</code> object as additional
       argument. 
       <br>
       For backward compatibility there exist second versions of
       each of these functions that still don't have a <code
       class="class">Mapping</code> argument. These functions
       implicitely use a mapping of the class <code
       class="class">MappingQ1</code>.
       <br>
       (RH 2001/03/27)

  <li> <p>
       New: <code class="class">Boundary</code> and derived classes
       now have a function <code
       class="member">get_normals_at_vertices</code> that returns a
       multiple of the normal vector to the boundary at the
       vertices of a given face. This is used in the construction of
       C<sup>1</sup> mappings of the boundary.
       <br>
       (WB 2001/03/23)
       </p>

  <li> <p>
       New: The new function <code
       class="class">PersistentTriangulation&lt;dim&gt;</code>::<code
       class="member">restore(unsigned int)</code> allows to restore
       the triangulation step by step.
       <br>
       New: Now there exists a function <code
       class="class">PersistentTriangulation&lt;dim&gt;</code>::<code
       class="member">clear_flags</code> to allow to re-<code
       class="member">read_flags</code> without the need of clearing
       the triangulation in advance.
       <br>
       New: The new function <code
       class="class">PersistentTriangulation&lt;dim&gt;</code>::<code
       class="member">n_refinement_steps</code> returns the number of
       refinement steps stored in <code
       class="member">refine_flags</code>.
       <br>
       (RH 2001/03/20)
       </p>

  <li> <p>
       New: <code class="class">GridGenerator</code>::<code
       class="member">hyper_rectangle</code> creates
       coordinate-parallel rectangles in arbitrary dimension.
       <br>
       (GK 2001/03/16)
       </p>

  <li> <p>
       Changed: The syntax of the <code
       class="class">FiniteElement&lt;dim&gt;</code>::<code
       class="member">get_unit_support_points</code> function is
       changed; it returns a reference to the vector of points in lieu
       of taking this vector as argument. The unit support points are
       now computed by the constructor of the <code
       class="class">FiniteElement</code> and not on each <code
       class="class">FiniteElement&lt;dim&gt;</code>::<code
       class="member">get_unit_support_points</code> function call as
       before.
       <br>
       (WB 2001/03/14)
       </p>

  <li> <p> 
       Removed: The function <code
       class="class">FiniteElement&lt;dim&gt;</code>::<code
       class="member">get_support_points</code>
       is removed as the <code class="class">FiniteElement</code>
       cannot know the position of the support points by itself. This is
       because the support points depend on the unit support points
       (known to the <code class="class">FiniteElement</code> class)
       but they also depend on the mapping.

       In future the support points can be computed using a <code
       class="class">FEValues</code> object initialized with the <code
       class="class">Mapping</code> and a <code
       class="class">Quadrature</code> that uses the unit support
       points as quadrature points.
       <br>
       (RH 2001/03/14)
       </p>

  <li> <p> 
       New: The class <code class="class">Boundary</code> has two new
       functions <code
       class="member">get_intermediate_points_on_line</code> and <code
       class="member">get_intermediate_points_on_quad</code> that
       needs to be implemented in derived classes only if <code
       class="class">GridOut</code> is used with <code
       class="class">MappingQ</code> of degree <code>p>2</code>.
       <br>
       (RH 2001/03/14)
       </p>

  <li> <p>

       New: The functions <code
       class="member">GridOut::write_gnuplot</code> and <code
       class="member">GridOut::write_eps</code> now take a pointer to
       a <code class="class">Mapping</code> object as additional
       argument. This allows to write grids in 2d whereby cells with a
       curved boundary are transformed by the given <code
       class="class">Mapping</code> class. The default mapping is
       <code class="class">MappingQ1</code>. Note, that the grids do
       not show the `original' domain with boundaries described by the
       <code class="class">Boundary</code> classes but the
       discretized domain whose boundary cells are transformed using the
       given mapping.
       </p>
       There are also a new <code
       class="member">GnuplotFlags::n_boundary_face_points</code> and
       <code class="member">EpsFlags::n_boundary_face_points</code>
       variables to set the number of additional points written
       to represent the curved boundary faces.
       <br>
       (RH 2001/03/14)
       </p>

  <li> <p>
       New: The constructor of the <code class="class">FEValues</code>
       and <code class="class">FE(Sub)FaceValues</code> classes now
       take a pointer to <code class="class">Mapping</code> object as
       additional argument. This is the new possibility to combine a
       <code class="class">FiniteElement</code> with an arbitrary
       <code class="class">Mapping</code>, see also <a
       href="#new_fe_mapping_design">New FE and Mapping Design</a>.
       </p>

       <p>
       For backward compatibility there still exists a constructor of
       <code class="class">FEValues</code> without a <code
       class="class">Mapping</code> argument that uses a <code
       class="class">MappingQ1</code> by default.
       <br>
       (RH 2001/03/14)
       </p>
       
  <li> <p>
       Changed: We now unconditionally include
       <code>deal.II/include/grid/tria_accessor.templates.h</code>
       (which containts some inline functions for triangulation
       accessor classes) into 
       <code>deal.II/include/grid/tria_accessor.h</code> to work
       around a problem with gcc3.0 which does not place a copy of
       these functions into the library. Previously we only included
       the file in optimized mode.
       <br>
       (RH 2001/03/14)
       </p>

  <li> <p>
       New: The class <code class="class">GridReordering::Cell</code> has
       now a copy constructor to work around a bug in a gcc3.0
       snapshot.
       <br>
       (RH, WB 2001/03/14)
       </p>

  <li> <p>
       Changed: when refining a hexahedron in 3d, the rules by which
       the new vertices at the centers of the faces and at the center
       of the cell are placed, are changed. They are changed in a way
       as to minimize the distortion of the resulting cells from the
       optimal shape and to make them look as much alike as possible
       to generate a smoother grid.
       <br>
       (WB 2001/03/02)
       </p>

  <li> <p>
       Fix: the <code
       class="member">DoFTools::compute_intergrid_constraints</code>
       function took memory quadratic in the number of degrees of
       freedom. This is now reduced to linear behaviour, with a
       constant that depends on the number of levels by which the two
       grids differ.
       <br>
       (WB 2001/02/26)
       </p>

  <li> <p>
       Fix: in the triangulation, the <code
       class="member">straight_boundary</code> variable, which is a
       reference, was assigned the address of a temporary object. It
       is unclear how this could have worked for three years, but it
       apparently did...
       <br>
       (WB 2001/02/26)
       </p>

  <li> <p> 
       New: The <code class="class">DoFTools</code> class now has
       a function <code class="member">count_dofs_per_component</code>
       that counts the number of degrees of freedom in each of the
       components of the finite element, i.e. how many degrees of
       freedom there are on the global mesh for each variable (field).
       <br>
       (WB 2001/02/22)
       </p>

  <li> <p>
       New: The <code class="class">CellAccessor</code> class now has a function
       <code class="member">has_boundary_lines</code> that mostly has
       the same semantics that <code class="member">at_boundary</code>
       has, but also covers the case that a hexahedron in 3d may be at
       the boundary only by one line, rather than by a whole face. In
       that case, <code class="member">at_boundary</code> reports
       false, while <code class="member">has_boundary_lines</code>
       reports true.
       <br>
       (WB 2001/02/21)
       </p>

  <li> <p>
       New: There is now a function
       <code class="member">ConstraintMatrix::merge</code> that merges
       the constraints represented by two constraint matrices into one
       object.
       <br>
       (WB 2001/01/31)
       </p>
</ol>

<hr>
Last update $Date$

</body>
</html>
