<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"
   "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
  <head>
    <link href="../../screen.css" rel="StyleSheet" media="screen">
    <link href="../../print.css" rel="StyleSheet" media="print">
    <title>The deal.II news page</title>
    <meta name="author" content="the deal.II authors <authors@dealii.org>">
    <meta name="keywords" content="deal.II"></head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<body>


<h2>Changes after Version 3.4</h2>

<p>
This is the list of changes made after the release of 
<acronym>deal.II</acronym> version 3.4. It is subdivided into changes
made to the three sub-libraries <a href="#base">base</a>, 
<a href="#lac">lac</a>, and <a href="#deal.II">deal.II</a>, as well as
changes to the <a href="#general">general infrastructure,
documentation, etc</a>.
</p>

<p>
All entries are signed with the names of the author. Regular
contributor's names are abbreviated by WB (Wolfgang Bangerth), GK
(Guido Kanschat), RH (Ralf Hartmann), BK (Benjamin S. Kirk).
</p>


<a name="general"></a>
<h3>General</h3>

<ol>
  <li> <p> 
       New: Since <code>math.h</code> only defines the values of PI or E (as
       <code>M_PI</code> and <code>M_E</code>) when certain defines are set (on
       Linux, these are <code>__USE_BSD</code> or <code>__USE_XOPEN</code>),
       portable programs usually defined these constants themselves. In
       <acronym>deal.II</acronym>, this happened at 6 different places. To
       avoid this in the future, <code>base/config.h</code> now exports a
       namespace <code>deal_II_numbers</code> that defines these two, and a
       number of other numerical constants.
       <br>
       (WB 2002/09/12)
       </p>

  <li> <p> 
       New: <code>base/config.h</code> now exports the
       <acronym>deal.II</acronym> base directory through the
       <code>DEAL_II_PATH</code> preprocessor variable.
       <br>
       (WB 2002/09/09)
       </p>

  <li> <p> 
       Removed: The forward declarations files have gone. We have never
       propagated their use in the example programs, but these files have been
       there in the base, lac, and grid include directories, and forward
       declared all classes that were present in the respective parts of the
       library. This, the idea was, enables you to use just this include file
       in your own header files, rather than including the full declarations of
       these classes. However, maintaining these forward declaration files has
       been a constant thorn in our side, be it that the timing of their
       generation was difficult when using parallel builds, or that they were
       difficult to generate at first. The latter is now the reason for their
       abolition: we had a script for their generation, but it did not take
       into account namespaces, so we got clashes when we found that we had
       used the same class name in two different namespaces, since the script
       put the forward declaration incorrectly into the global namespace where
       they conflicted. Since we do not plan to extend the script by a
       parser that can properly handle opening and closing braces of
       namespaces, we simply drop these files.
       <br>
       What you should do if you have used these forward declaration files: you
       have two possibilities - either include the respective header file in
       which the class is fully declared, or write the forward declaration into
       your headers yourself.
       <br>
       (WB 2002/09/05)
       </p>

  <li> <p> 
       New: There is now
       <a href="../../reports/assemble/index.html" target="body">a new report
       on assembling matrices</a> available from the 
       <a href="../../documentation.html" target="body">documentation
       page</a>. The main focus is assembling of matrices for
       vector-valued problems, where shape functions are
       vector-valued, and may have only one or more non-zero vector
       components. 
       <br>
       (WB 2002/06/17)
       </p>

  <li> <p>
       Removed: The functions <code
       class="member">FEValuesBase::get_shape_values</code>, <code
       class="member">FEValuesBase::get_shape_grads</code>, and <code
       class="member">FEValuesBase::get_shape_2nd_derivatives</code> are
       now removed as they expose too much of the internal data
       structure of their class, and interfere with plans for the
       extension of this and related classes. These functions, which
       had been deprecated in the previous version, are thus not
       part of the release after version 3.4 any more. Use the <code
       class="member">FEValuesBase::shape_value</code> and alike
       functions as a replacement.
       <br>
       For more information, read
       <a href="http://www.dealii.org/mail/msg00638.html" target="body">this mail</a>.
       <br>
       (WB 2002/06/10)
       </p>

  <li> <p> 
       New: <acronym>deal.II</acronym> now also supports vector-valued
       finite elements with shape functions for which more than just
       one vector component is non-zero. Such elements are, for
       example, the Nedelec and Raviart-Thomas families. Previously,
       vector-valued elements were only supported insofar as they
       could be composed of scalar ones; in that case, each
       (vector-valued) shape function had only one non-zero vector
       component.
       <br>
       (WB 2002/06/10)
       </p>

  <li> <p> 
       Improved: make knows a target <tt>veryclean</tt>
       now. <tt>clean</tt> leaves the libraries now, removing
       everything that is not needed to use
       <acronym>deal.II</acronym>. <tt>veryclean</tt> removes even the
       libraries, leaving the directory more or less in the state like
       after <tt>configure</tt>.
       <br>
       (GK 2002/06/07)
</ol>



<a name="base"></a>
<h3>base</h3>

<ol>
  <li> <p> 
       New: The <code class="member">Threads::n_existing_threads</code>
       function returns the present number of existing threads, allowing an
       assessment whether it is useful to spawn new threads or rather perform
       the operation in question sequentially.
       <br>
       (WB 2002/09/08)
       </p>

  <li> <p> New: Global exception class <code
       class="class">ExcIteratorPastEnd</code>, which should be used if an
       iterator is incremented or decremented beyond its end value.
       <br>
       (GK 2002/09/08)
       </p>

  <li> <p> 
       Extended: Previously, the <code class="class">Threads::PosixThreadBarrier</code>
       class could not be used at all (they threw exceptions), if your system
       did not have the respective POSIX functions. This restriction is lifted
       for the special case that you give one as the number of parties that
       will be waiting for the barrier: in this case, a barrier is a
       no-operation, so we do not need assistence from the operating
       system. This change makes it slightly simpler to write programs in a way
       such that they run in both single- and multithreaded environments.
       <br>
       (WB 2002/09/05)
       </p>

  <li> <p> 
       New: The old class <code class="class">vector2d</code>, implementing a
       two-dimensional array of objects is now gone. Instead, there is the new
       <code class="class">Table</code> class that implements tables of
       arbitrary dimension. Transition is painless: where there was
       <code>vector2d&lt;type&gt;</code> before, use
       <code>Table&lt;2,type&gt;</code> now (and don't forget to update the
       name of the header file, of course). If you have a three-dimensional
       array, you can use <code class="class">Table&lt;3,type&gt;</code> now.
       <br>
       (WB 2002/09/03)
       </p>

  <li> <p> 
       New: There are now functions returning the transpose of <code
       class="class">Tensor</code> objects of rank 2.
       <br>
       (WB 2002/08/31)
       </p>

  <li> <p> 
       New: Row accessors for the <code class="class">vector2d</code>
       class now have a member function <code
       class="member">size</code> that returns the size of the row,
       i.e. the number of columns of the table.
       <br>
       (WB 2002/07/24)
       </p>

  <li> <p> 
       Fixed: In EPS output, colors were set to invalid values if the
       values of the field that is used for coloring are all
       equal. This happens, for example, in the very first time step
       of time dependent problems, if initial values are zero. The
       color value now used is arbitrary, but valid.
       <br>
       (WB 2002/07/24)
       </p>

  <li> <p> 
       Changed: To save disk space, color values in EPS output are
       written as grey scale with only one value instead of three RGB
       values if the color so represented is actually a grey scale.
       <br>
       (WB 2002/07/24)
       </p>

  <li> <p> 
       New: There are now operators to allow multiplication and
       division of <code class="class">Tensor</code> objects by scalar
       factors.
       <br>
       (WB 2002/06/07)
       </p>
</ol>



<a name="lac"></a>
<h3>lac</h3>

<ol>
  <li> <p> Changed: The classes <code
  class="class">PreconditionBlock</code>, <code
  class="class">PreconditionBlockJacobi</code>, <code
  class="class">PreconditionBlockSOR</code>, and <code
  class="class">PreconditionBlockSSOR</code> have changed their
  template signature. The first template argument is now the matrix
  type, not just a number type.
  <br>
  (GK 2002/09/18)
  </p>

  <li> <p> New: class <code class="class">BlockVector</code> has a
  function <code class="member">collect_sizes()</code>, very much as
  <code class="class">BlockSparsityPattern</code>. This allows
  updating internal structures after blocks have been resized.
  <br>
  (GK 2002/09/17)
  </p>

  <li> <p> New: class <code class="class">SparseMatrix</code> has an
  STL-conforming <code class="class">const_iterator</code> and
  functions <code class="member">begin()</code> and <code
  class="member">end()</code> for looping through all existing
  entries. Furthermore, <code class="member">begin(row)</code> and
  <code class="member">end(row)</code> allow looping through all
  entries of a single line.
  <br>
  (GK 2002/09/11)
  </p>

  <li> <p>
       New: Classes <code class="class">SparsityPattern</code> and <code
       class="class">SparseMatrix</code> now have functions <code 
       class="member">block_write/block_read</code>, allowing to dump the data
       of these objects into a file in binary format, and later to re-read it
       without much need for parsing.
       <br>
       (WB 2002/09/09)
       </p>

  <li> <p>
       New: <code class="class">Vector</code> has a function <code
       class="member">lp_norm</code>, computing the <i>l<sub>p</sub></i>-norm
       of a vector for arbitrary <i>p</i>.
       <br>
       (GK 2002/08/13)
       </p>

  <li> <p> 
       New: a way of using abstract base classes for matrices has
       been implemented with <code class="class">PointerMatrixBase</code>
       and <code class="class">PointerMatrix</code>. Storing a matrix in
       <code class="class">PointerMatrix</code> allows to use the base
       class in functions only templated for the vector class.
       <br>
       (GK 2002/07/18)
  </p>
</ol>



<a name="deal.II"></a>
<h3>deal.II</h3>

<ol>
  <li> <p> 
       Changed: The <code
       class="member">FiniteElement::restriction_is_additive</code> function
       used to take an argument that denoted the vector component of a finite
       element. This has become difficult with elements that are non-zero in
       more than one vector component, such as the Nedelec element. Thus, the
       semantics of the function have been changed so that the argument now
       denotes the index of a shape function, rather than a vector
       component. Since the function is probably not used in application code,
       this will most probably not lead to more serious problems.
       <br>
       (WB 2002/09/16)

  <li> <p> 
       New: The mapping classes now also know how to transform tensors of rank
       2, not only vectors (tensors of rank 1) in a co- and contravariant way.
       <br>
       (WB 2002/09/03)

  <li> <p> 
       Fixed: the <code class="class">GridIn</code> class had problems
       when reading in UCD grids with comment lines that contained
       only the comment sign, but nothing else. This is now fixed.
       <br>
       (WB 2002/08/30)
  </p>

  <li> <p> 
       Improved: <code class="class">VectorTools</code>::<code
       class="member">integrate_difference</code> can compute <i>L<sup>p</sup></i>
       and <i>W<sup>1,p</sup></i> norms for arbitrary <i>p</i>. The function
       receives an additional optional argument <i>p</i> for this. All previous
       fuctionality remains unchanged, although the code has been cleaned up a bit.
       <br>
       (GK 2002/08/01)
  </p>

  <li> <p> New: The <code class="class">GridTools</code> class now
       offers functions to apply general transformations to all
       vertices of a triangulation, and also more specialized
       functions that shift, scale, and rotate triangulations.
       <br>
       (RH 2002/07/25)
       </p>

  <li> <p> New: The existing <code
       class="member">FETools::extrapolate</code> functions does not
       take into account hanging node constraints. Therefore, it works
       for continuous elements on globally refined grids and on
       discontinuous elements, only. Now, there is a new <code
       class="member">FETools::extrapolate</code> function with an
       additional <code class="class">ConstraintMatrix</code> argument
       for the hanging node constraints. This new function works for
       continuous as well as for discontinuous elements. But, the old
       function is still supported.
       <br>
       (RH 2002/06/17)
       </p>

  <li> <p> New: There are now <code
       class="member">Triangulation::save/load_user_pointers(vector&lt;void
       *&gt; &amp;)</code> functions similar to the respective <code
       class="member">Triangulation::save/load_user_flags(vector&lt;bool&gt;
       &amp;)</code> functions.
       <br>
       (RH 2002/06/14)
       </p>

  <li> <p> Fixed: Bug in <code
       class="member">Triangulation<3>::load_user_flags(vector&lt;bool&gt;
       &amp;)</code> is now fixed.
       <br>
       (RH 2002/06/14)
       </p>

  <li> <p> Fixed: <code
       class="member">Triangulation::load_user_flags(vector&lt;bool&gt;
       &amp;)</code> erroneously threw an assertion for
       <code>dim==1</code>. This is now fixed.
       <br>
       (RH 2002/06/14)
       </p>

  <li> <p> Changed: <code
       class="member">Triangulation<1>::n_quads</code> now returns 0,
       instead of throwing an assertion, as before. The same holds for
       similar functions like <code
       class="member">Triangulation&lt;dim&gt;::n_hexs</code> that now
       returns 0 for <code>dim<3</code>.
       <br>
       (RH 2002/06/14)
       </p>

  <li> <p> Improved: Several functions like the <code
       class="member">DoFHandler::distribute</code> and <code
       class="member">DoFTools::make_flux_sparsity_pattern</code>
       functions altered the <code
       class="member">user_flags</code>. This was stated in the
       documentation of these functions. Nevertheless, it might have
       led to unexpected behaviour of the <code
       class="member">user_flags</code> for users who weren't aware of
       this <em>side-effect</em>. Now, these functions do not alter
       the <code class="member">user_flags</code>, any
       more. Consequently, the users do not need to worry any more
       about the reliability of the <code
       class="member">user_flags</code> when calling any function of
       the library.
       <br>
       (RH 2002/06/14)
       </p>  

  <li> <p> Fixed: <code
       class="member">FE_Q::has_support_on_face</code> always returned
       true in 1d, partly because faces are not really an issue in
       1d. It now does so only when the support point of the
       respective shape function is actually the requested vertex. The
       same applied to <code
       class="member">FE_DGQ::has_support_on_face</code>
       <br>
       (WB 2002/06/13)
       </p>

  <li> <p> New: The existing <code
       class="member">FETools::interpolate</code>, <code
       class="member">FETools::back_interpolate</code> and <code
       class="member">FETools::interpolate_difference</code> functions
       do not take into account hanging node constraints. Therefore,
       they work for continuous elements on globally refined grids and
       on discontinuous elements, only. Now, there are new functions
       with the same names but additional <code
       class="class">ConstraintMatrix</code> arguments for the hanging
       node constraints. These new functions work for continuous as
       well as for discontinuous elements. But, the old functions are
       still supported.
       <br>
       (RH 2002/06/13)
       </p>

  <li> <p> Changed: The constructor of <code
       class="class">DoFHandler</code> now takes a reference to a
       <code>const</code> <code class="class">Triangulation</code>.
       <br>
       (RH 2002/06/12)
       </p>

  <li> <p> Changed: The constructors of all <code
       class="class">DoFAccessor</code>, <code
       class="class">TriaAccessor</code> and <code
       class="class">TriaIterator</code> classes now take pointers to
       <tt>const</tt> <code class="class">Triangulation</code>s.
       <br>
       (RH 2002/06/12)
       </p>

  <li> <p> Fixed: In debug mode the <code
       class="member">MappingQ1::transform_real_to_unit_cell</code>
       function erroneously threw an assertion when used in 1 or 3
       dimensions. This is now fixed.
       <br>
       (RH 2002/06/10)
       </p>

  <li> <p> 
       Fixed: The <code class="member">get_dof_indices</code>
       functions of DoF accessor classes used to work also for
       non-active cells. However, the results were bogus except for
       the special case that we had a finite element that has all its
       degrees of freedom located in vertices. This is now fixed: the
       function throws an exception in all other cases, since there is
       no useful meaning for it then. It continues to work in the
       special case.
       <br>
       (WB 2002/06/08)
       </p>

  <li> <p> 
       New: For encapsulated postscript of 2d grids, it is now
       possible to tell the <code class="class">GridOut</code> to
       write the cell numbers into each cell, as well as the numbers
       of the vertices.
       <br>
       (WB 2002/06/04)
       </p>
</ol>

<hr>
Last update $Date$

</body>
</html>
