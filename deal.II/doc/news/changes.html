<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN"
   "http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
  <head>
    <link href="../screen.css" rel="StyleSheet">
    <title>The deal.II news page</title>
    <meta name="author" content="the deal.II authors <authors@dealii.org>">
    <meta name="keywords" content="deal.II"></head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<body>


<h2>Changes after Version 5.1</h2>

<p>
This is the list of changes made after the release of 
<acronym>deal.II</acronym> version 5.1. It is subdivided into changes
made to the three sub-libraries <a href="#base">base</a>, 
<a href="#lac">lac</a>, and <a href="#deal.II">deal.II</a>, as well as
changes to the <a href="#general">general infrastructure,
documentation, etc</a>.
</p>

<p>
All entries are signed with the names of the author. Regular
contributor's names are abbreviated by WB (Wolfgang Bangerth), GK
(Guido Kanschat), RH (Ralf Hartmann).
</p>


<a name="incompatible"></a>
<h3 style="color:red">Incompatibilities</h3>

<p style="color:red">
Following are a few modifications to the library that unfortunately
are incompatible with previous versions of the library, but which we
deem necessary for the future maintainability of the
library. Unfortunately, some of these changes will require
modifications to application programs. We apologize for the
inconvenience this causes.
</p>


<ol>
  <li> <p>Changed: The way boundary constraints were handled in the step-17
  tutorial program was conceptually flawed. We tried to eliminate boundary
  nodes locally on the cell level, and hanging node constraints subsequently
  when transferring into the global matrix. However, this doesn't work in
  general: the elimination of hanging node constraints could re-populate rows
  and columns that had already been vacated during boundary node
  elimination. At the end of a long though process, we came to the conclusion
  that it is impossible to revert the traditional order of operations: first
  eliminate all hanging node constraints, then eliminate all boundary
  nodes. This leads to a situation where the <code
  class="member">MatrixTools::local_apply_boundary_values</code> function is
  not very useful any more, except for the special case where there are no
  hanging nodes. The step-17 example program has therefore been changed to use
  the <code class="member">MatrixTools::apply_boundary_values</code> function
  again, though hanging node elimination still happens during transfer into
  the global matrix.
  <br> (WB 2005/05/05)
  </p>

  <li> <p>Changed: The class <code
  class="class">MGCoarseGridLACIteration</code> lost two template
  arguments. Since the matrix and preconditioner are now stored in
  form of <code class="class">PointerMatrix</code> objects, handling
  of the class is much simpler, in particular when exchanging
  preconditioners.
  <br> (GK 2005/05/03)
  </p>

  <li> <p>Changed: The template argument of <code
  class="class">BlockMatrixArray</code> was changed to
  <tt>number</tt>, equal to the same argument of the used <code
  class="class">BlockVector</code>. Furthermore, its constructor
  requires an additional argument of type <code
  class="class">VectorMemory&lt;Vector&lt;number&gt; &gt;</code>
  providing space for auxiliary vectors. Since the entries are now of
  type <code class="class">PointerMatrixBase</code>, even matrices
  with blocks of different types can be constructed.
  <br> (GK 2005/03/21)
  </p>

  <li> <p>Changed: The <code class="class">GeometryInfo</code>::<code
  class="member">vertices_adjacent_to_line</code> function has been
  renamed to <code class="class">GeometryInfo</code>::<code
  class="member">line_to_cell_vertices</code> to be named analogous to
  the <code class="member">face_to_cell_vertices</code>, <code
  class="member">face_to_cell_lines</code> and <code
  class="member">child_to_cell_coordinates</code> functions.
  <br>
  (RH 2005/03/14)
  </p>

  <li> <p>Changed: the file <tt>multigrid/mg_dof_tools.h</tt> was
  renamed to <tt>multigrid/mg_tools.h</tt> in order to match the name
  of the class contained.
  <br>
  (GK 2005/03/09)
  </p>

  <li> <p>Changed: <code class="class">DoFTools</code>::<code
  class="member">make_flux_sparsity_pattern</code>, <code
  class="class">MGTools</code>::<code
  class="member">make_flux_sparsity_pattern</code> and similar
  functions in these classes do not receive arguments of type <code
  class="class">FullMatrix&lt;double&gt;</code> anymore. Instead, they
  get a <code class="class">Table&lt;2,DoFTools::Coupling&gt;</code>,
  which contains more meaningful enums.
  <br>
  (GK 2005/03/09)
  </p>

  <li> <p>Changed: <code class="class">Multigrid</code>::<code
  class="member">Multigrid</code> receives an argument determining the
  type of multigrid cycle istead of the minimum and maximum
  levels. The latter were rarely used anyway and can be modified by
  <code class="member">set_minlevel()</code> and <code
  class="member">set_maxlevel()</code>
  <br>
  (GK 2005/03/09)
  </p>

</ol>

<a name="general"></a>
<h3>General</h3>

<ol>
  <li> <p>
       Fixed: The step-17 example program had a stupid mistake in that it
       initializes the <code>pcout</code> variable with an uninitialized value
       of <code>mpi_communicator</code>. While this seems to have worked for
       some older MPI implementations, this is no longer the case on some
       other systems. It is now fixed.
       <br>
       (WB, 2005/04/18)
       </p>

  <li> <p>
       New: If there are references to other example programs in any of the
       step-XX programs, then they will now show up as crosslinks in the HTML
       version for simpler navigation of the tutorial.
       <br>
       (WB, 2005/04/04)
       </p>

  <li> <p>
       New: The configuration script can now enable special optimizations for
       x86-like processors if called with the <code>--with-cpu=...</code> option.
       This can decrease computation time by up to 30% on certain systems.
       The configuration flag has already existed for PowerPC64 processors, but
       was not documented. Documentation has been added.
       <br>
       (Ralf B. Schulz, 2005/03/10)
       </p>

  <li> <p>
       Fixed: When compiling shared libraries on CygWin systems, warnings
       concerning the <code>-fPIC</code> option were issued by the compiler.
       This is now fixed.       
       Also, configure now issues a message at the end that you should include
       the DLL-path in your <code>.bash_profile</code> file on these systems.
       <br>
       (Ralf B. Schulz, 2005/03/10)
       </p>

  <li> <p>
       Fixed: On certain systems running CygWin, a call to socket functions
       like <code>gethostname()</code> could cause deal.II to hang. The reason
       seems to be that the call disables long double computations which
       revert to just double precision. This then leads to an endless loop in
       computing weights for quadrature points because the convergence
       criterion cannot be reached with simple double precision. This is now
       fixed by disabling the call to <code>gethostname()</code> on these
       systems. A new preprocessor variable, <code>DEAL_II_BROKEN_SOCKETS</code>
       has been added to <code>base/config.h</code> which is defined on
       affected systems.
       <br> 
       (Ralf B. Schulz, WB, 2005/03/02)
       </p>

  <li> <p>
       Fixed: The step-16 example program wasn't listed in the
       navigation bar of the  tutorial section, although it was in the
       table of contents. This is fixed now.
       <br> 
       (WB, 2005/02/09)
       </p>
</ol>



<a name="base"></a>
<h3>base</h3>

<ol>  
  <li> <p>
       New: The <code class="class">Tensor</code> classes now
       have member functions that compute the Frobenius norm and its
       square. There are also global <code>operator*</code> functions
       that compute the contraction over a pair of indices of tensors.
       <br>
       (WB, 2005/04/06)
       </p>

  <li> <p>
       New: The <code class="member">DataOutBase</code> class now
       allows to write data in a new intermediate format that
       basically dumps the raw information available in patches.
       <br>
       (WB, 2005/04/05)
       </p>

  <li> <p>
       New: The <code class="member">DataOutReader</code> class allows
       to read data back in from a file into which it has been written
       using intermediate format. From there, it can then be converted
       into any of the supported graphics formats.
       <br>
       (WB, 2005/04/05)
       </p>

  <li> <p>
       New: There is now a <code
       class="member">operator &gt;&gt; (std::istream &amp;in,
       Point&lt;dim&gt; &amp;p)</code>, a function that had apparently been
       missing for a long time already.
       <br>
       (WB, 2005/04/05)
       </p>

  <li> <p>
       New: The new function <code
       class="member">double_contract</code> contracts two tensors of
       rank 4 and 2 into a tensor of rank 2, by contracting over two
       indices at the same time.
       <br> 
       (WB, 2005/03/29)
       </p>

  <li> <p>
       New: The new function <code
       class="member">TableIndicesBase::sort</code> allows to sort the indices
       in ascending order. This is useful for cases where the order of indices
       is irrelevant (for example in symmetric tables).
       <br> 
       (WB, 2005/03/29)
       </p>

  <li> <p>
       New: There is a new class <code class="class">SymmetricTensor</code>
       that provides storage and operations for symmetric tensors.
       <br> 
       (WB, 2005/03/28)
       </p>

  <li> <p>
       New: Class <code class="class">Subscriptor</code> receives a
       text argument allowing to identify the violating pointer more
       easily. The additional feature is being incorporated into <code
       class="class">SmartPointer</code> constructors throughout the
       library.
       <br> 
       (GK, 2005/03/16)
       </p>

  <li> <p>
       New: Class <code class="class">FunctionParser</code>. Wrapper
       class for the fparser library (see 
       <a href="http://www.students.tut.fi/~warp/FunctionParser/">
       http://www.students.tut.fi/~warp/FunctionParser/</a>).
       <br> 
       (Luca Heltai, 2005/03/07).
       </p>

  <li> <p>
       New: Class <code class="class">PathSearch</code> allows to find
       a file in a sequence of directories and by appending suffixes.
       <br> 
       (GK, 2005/03/02)
       </p>

  <li> <p>
       Fixed: The class <code
       class="class">MultipleParameterLoop::UserClass</code> had only 
       virtual abstract functions but no virtual destructor. This caused
       warnings with some compilers, and is generally bad practice
       anyway. This is now fixed. The same holds with respect to the class
       <code class="class">DataOutInterface</code>.
       <br> 
       (WB, 2005/02/20)
       </p>
</ol>



<a name="lac"></a>
<h3>lac</h3>

<ol>
  <li> <p>
       Improved: <code class="class">SparseDirectUMFPACK</code> now
       has the complete interface of a preconditioner
       class. Therefore, it can be used in iterative solvers and in
       multigrid smoothers.
       <br> 
       (GK, 2005/05/10)
       </p>

  <li> <p>
       Fixed: The PETSc matrix iterators had trouble when some rows of a
       matrix were empty. This has now been mostly fixed.
       <br> 
       (WB, 2005/05/02)
       </p>

  <li> <p>
       Fixed: The <code class="class">PETScWrappers::MPI::SparseMatrix</code>
       class had functions that allow to take a pre-existing sparsity pattern
       as the basis for entry allocation. These function had an option to
       allow pre-setting these entries in the underlying data structures, but
       this option was disabled by default because of unresolved questions
       about its effectiveness. This has now been fixed: The code now properly
       initializes these elements, and makes the resulting matrix much faster
       to use.
       <br> 
       (WB, 2005/04/04)
       </p>

  <li> <p>
       New: The <code class="class">ProductSparseMatrix</code>
       implements the product of two rectangular sparse matrices with
       the same <code class="member">value_type</code>
       <br> 
       (GK, 2005/03/11)
       </p>

  <li> <p>
       New: The <code class="class">PreconditionRichardson</code>
       implements a Richardson preconditioner.
       <br> 
       (GK, 2005/03/10)
       </p>

  <li> <p> Fixed: The <code class="class">BlockSparseMatrix</code>
       class had no local typedef <code
       class="member">value_type</code> like all other classes, which
       made it a little awkward to use in some places. This has now
       been fixed.

       <br> 
       (WB, 2005/03/03)
       </p>

  <li> <p> Fixed: The <code class="class">PETScWrappers</code>::<code
       class="member">MatrixBase</code> class documented that adding
       or setting a value that hasn't been in the sparsity pattern
       before will lead to an exception being thrown. This is of
       course wrong: PETSc allocates matrix entries dynamically, as
       needed. The documentation is now fixed.
       <br> (WB, 2005/03/03)
       </p>

  <li> <p> New: The <code class="class">SparseMatrix</code> iterators
       had no <code class="member">operator &gt;</code>, only an <code
       class="member">operator &lt;</code>. The missing operator is
       now implemented. The same holds for the <code
       class="class">FullMatrix</code> class.
       <br> (WB, 2005/03/01)
       </p>

  <li> <p> Fixed: The <code class="class">SparseMatrix</code>
       iterators could not be compared using <code
       class="member">operator &lt;</code>: the compiler complained
       that a private member was accessed. This is now fixed.
       <br> (WB, 2005/03/01)
       </p>
</ol>



<a name="deal.II"></a>
<h3>deal.II</h3>

<ol>
  <li> <p>
       New: The <code class="member">MatrixTools::apply_boundary_values</code>
       function now also works for PETSc sequential and parallel matrices.
       <br> 
       (WB, 2005/05/05)
       </p>

  <li> <p>
       Improved: The function<code class="class">GridIn</code>::<code
       class="member">read</code> now searches for files using the
       mechanism provided by the class <code
       class="class">PathSearch</code>. Furthermore, a library of input
       meshes has been started in <code>lib/meshes</code>.
       <br> 
       (GK, 2005/05/03)
       </p>

  <li> <p>
       Fixed: The <code class="class">DataOut</code> class did not work
       properly if the <code class="member">DataOut::first_cell</code> and
       <code class="member">DataOut::next_cell</code> functions were
       overloaded and cell data was to be output; in that case, data from the
       wrong cells was written out. This is now fixed. In contrast to this,
       nodal data was never affected.
       <br> 
       (WB, 2005/04/20)
       </p>

  <li> <p>
       Improved: By employing the new <code
       class="class">GeometryInfo</code>::<code
       class="member">line_to_cell_vertices</code>, <code
       class="class">GeometryInfo</code>::<code
       class="member">face_to_cell_vertices</code> and <code
       class="class">GeometryInfo</code>::<code
       class="member">face_to_cell_lines</code> functions the <code
       class="class">Triangulation</code>::<code
       class="member">create_triangulation</code> functions are now
       implemented independent of given conventions for the numbering
       of vertices, lines and faces.
       <br>
       (RH, 2005/03/11)
       </p>

  <li> <p>
       New: The new <code class="class">GeometryInfo</code>::<code
       class="member">line_to_cell_vertices</code> function maps line
       vertex numbers to cell vertex numbers.
       <br> 
       (RH, 2005/03/11)
       </p>

  <li> <p>
       New: The new <code class="class">GeometryInfo</code>::<code
       class="member">face_to_cell_lines</code> function maps face
       line numbers to cell line numbers.
       <br> 
       (RH, 2005/03/11)
       </p>

  <li> <p>
       New: The new <code class="class">GeometryInfo</code>::<code
       class="member">face_to_cell_vertices</code> function maps face
       vertex numbers to cell vertex numbers.
       <br> 
       (RH, 2005/03/11)
       </p>

  <li> <p>
       Fixed: There was a bug in the <code
       class="class">KellyErrorEstimator</code> class that resulted in
       assertions being thrown when run with multithreading
       enabled. This is now fixed.
       <br> 
       (WB, 2005/03/10)
       </p>

  <li> <p>
       Changed: The <code class="class">Triangulation<2></code>::<code
       class="member">execute_refinement</code> function has been
       re-implemented to accommodate future developments. This change
       results in different ordering and indexing of lines and
       vertices. This leads to a change in the ordering of vertices in
       output files generated by <code class="class">GridOut</code>
       for refined grids.
       <br> 
       (RH, 2005/03/09)
       </p>

  <li> <p>
       Fixed: The class <code>MGDoFHandler</code> had trouble when it
       encountered a triangulation that had unused vertices, something
       that happens when one coarsens an existing triangulation. In
       that case, it would throw unjustified exceptions. This is now
       fixed.
       <br> 
       (WB, 2005/03/01)
       </p>

  <li> <p>
       Fixed: The class <code>Triangulation::RefinementListener</code> had only
       virtual abstract functions but no virtual destructor. This caused
       warnings with some compilers, and is generally bad practice
       anyway. This is now fixed.
       <br> 
       (WB, 2005/02/22)
       </p>

  <li> <p>
       New: Function <code class="class">FETools</code>::<code
       class="member">compute_embedding_matrices</code> allows for
       automatic computation of embedding matrices under the sole
       assumption that the coarse grid space is embedded into the fine
       grid space. In particular, no interpolation points are required.
       <br> 
       (GK, 2005/02/08)
       </p>

  <li> <p>
       Fixed: Several wrong assertions in the Raviart-Thomas finite element
       class have been fixed, that were triggered when integrating face terms.
       <br> 
       (Oliver Kayser-Herold, 2005/01/24; 
        WB, 2005/01/31)
       </p>
</ol>

<hr>
Last update $Date$

</body>
</html>
