# $Id$

###############################
# Configured variables

D        = @DEAL2_DIR@
multigrid= @enablemultigrid@
kdocdir  = $(HOME)/tmp/kdoc


include $D/common/Make.global_options

KDOCFLAGS=-I$(kdocdir) $(kdocdir)/kdoc -a -p -L $D/doc/auto/kdoc

# generic targets
default: autogen-doc tutorial development glossary validate-xrefs

all: default autogen-doc-all


# specific targets
autogen-doc:
	cd auto ; $(MAKE) multigrid=$(multigrid) 'KDOCFLAGS=$(KDOCFLAGS)'


autogen-doc-all: 
	cd auto ; $(MAKE) all multigrid=$(multigrid) 'KDOCFLAGS=$(KDOCFLAGS)'


tutorial:
	cd tutorial ; $(MAKE)

development:
	cd development ; $(MAKE)

glossary:
	cd glossary ; $(MAKE)


validate-xrefs:
	@echo "Validating cross-references in HTML files."
	$(PERL) $D/doc/auto/scripts/validate-xrefs.pl *html
	cd tutorial ; $(MAKE) validate-xrefs
	cd development ; $(MAKE) validate-xrefs
	cd glossary ; $(MAKE) validate-xrefs
	cd publications ; $(MAKE) validate-xrefs


clean:
	cd auto ; $(MAKE) clean
	cd tutorial ; $(MAKE) clean
	cd development ; $(MAKE) clean
	cd glossary ; $(MAKE) clean


.PHONY: default all autogen-doc autogen-doc-all tutorial clean development validate-xrefs glossary
