# $Id$

###############################################################################
## Please note:
##   The ./configure script generates Make.global_options from 
##   Make.global_options.in, so if you want to change something,
##   then do it in the latter file and re-run ./configure in the
##   top level directory
##
##
##   This file exports several variables. They are documented in 
##   the file  doc/development/makefiles.html.
###############################################################################



######################################################
# the following lines will be replaced by the output 
# of ./configure

D                    = @DEAL2_DIR@
CC                   = @CC@
CXX                  = @CXX@
GXX-VERSION          = @GXX_VERSION@
SHLIBLD              = @SHLIBLD@
AR                   = @AR@
RANLIB               = @RANLIB@
LDFLAGS              = @LDFLAGS@
F77                  = @F77@
F77-VERSION          = @F77_VERSION@
F77LIBS              = @F77LIBS@
LIBS                 = @LIBS@
LIBDIR               = $D/lib
PERL                 = @PERL@
enable-multithreading= @enablemultithreading@
with-multithreading  = @withmultithreading@
enable-shared        = @enableshared@
DEAL_II_MAJOR        = @DEAL_II_MAJOR@
DEAL_II_MINOR        = @DEAL_II_MINOR@
USE_CONTRIB_HSL      = @USE_CONTRIB_HSL@
TECIO_INCLUDE        = @TECPLOT_INCLUDE_PATH@
TECIO_LIBRARY        = @TECPLOT_LIBRARY_PATH@
TARGET               = @target@

# if HSL sublibs are used, add F77 libs to linker flags
ifeq ($(USE_CONTRIB_HSL),yes)
  LDFLAGS += $(F77LDFLAGS)
  LIBS    += $(F77LIBS)
endif

# if Tecplot is used, link against tecio.a
LIBS += $(TECIO_LIBRARY)

######################################################
# now configuration for compiler flags, pathes, etc

# path for libraries 

LIBPATH    += $(addprefix -L,$(libdir))


# add search path for libraries for make dependencies

vpath %.a $(libdir)
vpath %.so $(libdir)



lib-suffix = @lib_suffix@
OBJEXT     = @OBJEXT@
EXEEXT     = @EXEEXT@

lib-base.o     = $(LIBDIR)/libbase$(lib-suffix)
lib-base.g     = $(LIBDIR)/libbase.g$(lib-suffix)

lib-lac.o      = $(LIBDIR)/liblac$(lib-suffix)
lib-lac.g      = $(LIBDIR)/liblac.g$(lib-suffix)

lib-deal2-1d.o = $(LIBDIR)/libdeal_II_1d$(lib-suffix)
lib-deal2-2d.o = $(LIBDIR)/libdeal_II_2d$(lib-suffix)
lib-deal2-3d.o = $(LIBDIR)/libdeal_II_3d$(lib-suffix)

lib-deal2-1d.g = $(LIBDIR)/libdeal_II_1d.g$(lib-suffix)
lib-deal2-2d.g = $(LIBDIR)/libdeal_II_2d.g$(lib-suffix)
lib-deal2-3d.g = $(LIBDIR)/libdeal_II_3d.g$(lib-suffix)

lib-contrib-hsl = $(LIBDIR)/libhsl$(lib-suffix)

# if HSL is used, always link it in conjunction with liblac
ifeq ($(USE_CONTRIB_HSL),yes)
  lib-lac.g += $(lib-contrib-hsl)
  lib-lac.o += $(lib-contrib-hsl)
endif


# include paths. do not take into account a possibly existing
# environment variable, since the compiler will evaluate the value of
# that anyway at compile time

include-path-base          = $D/base/include
include-path-lac           = $D/lac/include
include-path-deal2         = $D/deal.II/include
include-path-contrib-hsl   = $D/contrib/hsl/include
include-path-contrib-boost = $D/contrib/boost/include
include-path-tecplot       = $(TECIO_INCLUDE)


INCLUDE           = $(addprefix -I, $(include-path-base) \
                                    $(include-path-lac)  \
                                    $(include-path-deal2)\
			            $(include-path-contrib-hsl)\
			            $(include-path-contrib-boost)\
				    $(include-path-tecplot))

# compiler flags for debug and optimized mode
CXXFLAGS.g   = @DEFS@ @CXXFLAGSG@  $(INCLUDE)
CXXFLAGS.o   = @DEFS@ @CXXFLAGSO@  $(INCLUDE)

F77FLAGS.g   = @DEFS@ @F77FLAGSG@  $(INCLUDE)
F77FLAGS.o   = @DEFS@ @F77FLAGSO@  $(INCLUDE)

ifeq ($(enable-shared),yes)
  CXXFLAGS.g += @CXXFLAGSPIC@
  CXXFLAGS.o += @CXXFLAGSPIC@

  F77FLAGS.g += @F77FLAGSPIC@
  F77FLAGS.o += @F77FLAGSPIC@

  LDFLAGS    += @LDFLAGSPIC@
endif
