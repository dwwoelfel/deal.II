############################################################
# $Id$
# Copyright (C) 2000, 2001, 2002 by the deal.II authors
############################################################

############################################################
# Include general settings for including DEAL libraries
############################################################

D = @DEAL2_DIR@
include $D/common/Make.global_options
debug-mode = off

libraries = $(lib-deal2-1d.o) \
            $(lib-deal2-2d.o) \
            $(lib-deal2-3d.o) \
            $(lib-lac.o)  \
            $(lib-base.o)

############################################################
# First how to create executables, including all necessary
# flags:
############################################################

flags     = $(CXXFLAGS.o)

ifeq ($(findstring gcc,$(GXX_VERSION)),gcc)
flags += -Wno-missing-noreturn
endif

%.g.o : %.cc Makefile
	@echo =====debug========= $<
	@$(CXX) $(CXXFLAGS.g) -c $< -o $@
%.o : %.cc Makefile
	@echo =====optimized===== $<
	@$(CXX) $(CXXFLAGS.o) -c $< -o $@
%.exe :
	@echo =====linking======= $@
	@$(CXX) $(LDFLAGS) -o $@ $^ $(LIBS)


default: embedding.exe interpolation.exe

############################################################

embedding.exe    : embedding.o  $(libraries)
interpolation.exe: interpolation.o $(libraries)

############################################################
# Automatic generation of dependencies
############################################################

Makefile.depend: $(shell echo *.cc)
	@echo =====Dependencies== $@
	@$(CXX) $(CXXFLAGS.g) $^ -M > $@
	@perl -pi -e 's/(^[^.]+)\.o:/\1.o \1.g.o:/;' $@

include Makefile.depend
